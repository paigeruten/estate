<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0107)redhanded.hobix.com/inspect/howToLetAnyoneElseFinishYourWiki.html -->
<HTML xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><HEAD><META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--<BASE href="http://redhanded.hobix.com.wstub.archive.org/inspect/howToLetAnyoneElseFinishYourWiki.html">--><BASE href=".">


<TITLE>RedHanded » Open Up Your Wiki and We'll Finish it For You</TITLE>
<LINK rel="shortcut icon" href="../favicon.ico" type="image/vnd.microsoft.icon" />
<LINK rel="icon" href="../favicon.ico" type="image/vnd.microsoft.icon" />
<META http-equiv="Pragma" content="no-cache">
<META http-equiv="Expires" content="-1">




<STYLE type="text/css">
 @import "../site.css"; 
</STYLE>
</HEAD><BODY>

<DIV id="page">

<DIV id="hoodwinkd">
  <A href="http://hoodwinkd.hobix.com/"><SPAN>hoodwink.d enhanced</SPAN></A>

</DIV>
<DIV id="buttons">
<DL class="tab">
  <DT><A title="Syndicate this Site" href="index.xml">RSS</A></DT>
  <DD><A title="Syndicate this Site" href="index.xml">2.0</A></DD>
</DL>
<DL class="tab xhtml">
  <DT><A title="Validate this Site" href="http://validator.w3.org/check?uri=http://redhanded.hobix.com/">XHTML</A></DT>
  <DD><A title="Validate this Site" href="http://validator.w3.org/check?uri=http://redhanded.hobix.com/">1.0</A></DD>
</DL>
</DIV>
<H1 class="title"><A href="../"><IMG src="../images/redhanded.gif" alt="RedHanded"></A></H1>
<DIV id="banner">
  <DIV class="tagline">sneaking Ruby through the system</DIV>
  <DIV class="nav"><A href="../5.gets/">5.gets</A> | <A href="../bits/">bits</A> | 
    <A href="../inspect/">inspect</A> | <A href="../cult/">the cult</A> | <A href="../-h/">-h</A></DIV>
</DIV>


<DIV id="content">
<DIV id="sidebar">
<P>New to RedHanded? <A href="../-h/pardonAndWelcome.html">About our sections.</A></P>

<DIV class="sidebarBox">
<H2 class="sidebarTitle">Archive</H2>
<UL>

    <LI><A href="../2004/12/">December 2004</A></LI>

    <LI><A href="../2005/01/">January 2005</A></LI>

    <LI><A href="../2005/02/">February 2005</A></LI>

    <LI><A href="../2005/03/">March 2005</A></LI>

    <LI><A href="../2005/04/">April 2005</A></LI>

    <LI><A href="../2005/05/">May 2005</A></LI>

    <LI><A href="../2005/06/">June 2005</A></LI>

    <LI><A href="../2005/07/">July 2005</A></LI>

    <LI><A href="../2005/08/">August 2005</A></LI>

    <LI><A href="../2005/09/">September 2005</A></LI>

    <LI><A href="../2005/10/">October 2005</A></LI>

    <LI><A href="../2005/11/">November 2005</A></LI>

    <LI><A href="../2005/12/">December 2005</A></LI>

    <LI><A href="../2006/01/">January 2006</A></LI>

    <LI><A href="../2006/02/">February 2006</A></LI>

    <LI><A href="../2006/03/">March 2006</A></LI>

    <LI><A href="../2006/04/">April 2006</A></LI>

    <LI><A href="../2006/05/">May 2006</A></LI>

    <LI><A href="../2006/06/">June 2006</A></LI>

    <LI><A href="../2006/07/">July 2006</A></LI>

    <LI><A href="../2006/08/">August 2006</A></LI>

    <LI><A href="../2006/09/">September 2006</A></LI>

    <LI><A href="../2006/10/">October 2006</A></LI>

    <LI><A href="../2006/11/">November 2006</A></LI>

    <LI><A href="../2006/12/">December 2006</A></LI>

    <LI><A href="../2007/01/">January 2007</A></LI>

    <LI><A href="../2007/02/">February 2007</A></LI>

    <LI><A href="../2007/03/">March 2007</A></LI>

    <LI><A href="../2007/04/">April 2007</A></LI>

    <LI><A href="../2007/05/">May 2007</A></LI>

</UL>
</DIV>

<P><A href="http://www.pragmaticprogrammer.com/titles/ruby/index.html"><IMG src="../images/prag-ruby-book.jpg" alt="PickAxe II"></A><BR>
<A href="http://www.pragmaticprogrammer.com/titles/ruby/index.html">Get your copy of <I>Programming Ruby</I>!</A></P>

 <DIV class="sidebarBox">
        <H2 class="sidebarTitle">Links</H2>
        <A href="http://technorati.com/tags/ruby">@technorati</A><BR>
<A href="http://del.icio.us/tag/ruby">@del.icio.us</A><BR>
<A href="http://www.flickr.com/photos/tags/ruby">@flickr</A><BR>
<A href="http://www.artima.com/articles/index.jsp?topic=ruby">@artima</A><BR>
<A href="http://blog.caboo.se/">@caboo</A><BR>
<A href="http://www.oreillynet.com/ruby">@oreilly</A><BR>
<A href="http://ruby-lang.org/">ruby</A><BR>
<A href="http://ruby-doc.org/">-&gt; docs</A><BR>
<A href="http://rubyforge.org/">-&gt; wares</A><BR>
<A href="http://rubygarden.org/ruby/">-&gt; wiki</A><BR>
<A href="http://www.sitepoint.com/forums/forumdisplay.php?f=227">-&gt; forum</A><BR>
<A href="http://www.rubyquiz.com/">-&gt; quizzes</A><BR>
<A href="http://planetruby.0x42.net/">-&gt; planet</A><BR>
<A href="http://meme.b9.com/cdates.html?channel=ruby-lang">-&gt; irc</A><BR>
<A href="http://www.rubyweeklynews.org/">rubyweeklynews</A><BR>
<A href="http://weblog.rubyonrails.com/">rails</A><BR>
<A href="http://wiki.rubyonrails.org/">-&gt; wiki</A><BR>
<A href="http://www.planetrubyonrails.org/">-&gt; planet</A><BR>
<A href="http://thesaq.com/rubyonrails/">-&gt; irc</A><BR>
<A href="http://anarchaia.org/">%anarchaia</A><BR>
<A href="http://project.ioni.st/">%projectionist</A><BR>
<A href="http://pugs.blogs.com/">~audreyt</A><BR>
<A href="http://dablog.rubypal.com/">~black</A><BR>
<A href="http://www.jamesbritt.com/">~britt</A><BR>
<A href="http://www.jamisbuck.org/jamis/">~buck</A><BR>
<A href="http://tomcopeland.blogs.com/juniordeveloper/">~copeland</A><BR>
<A href="http://eigenclass.org/">~fernandez</A><BR>
<A href="http://www.chadfowler.com/">~fowler</A><BR>
<A href="http://www.loudthinking.com/">~hansson</A><BR>
<A href="http://blog.segment7.net/">~hodel</A><BR>
<A href="http://slash7.com/">~hoy/7</A><BR>
<A href="http://fhwang.net/">~hwang</A><BR>
<A href="http://blog.leetsoft.com/">~luetke</A><BR>
<A href="http://www.worldlingo.com/wl/translate?wl_lp=JA-en&wl_glossary=gl1&wl_fl=3&wl_rurl=http%3A%2F%2Fwww.rubyist.net%2F%7Ematz%2F&wl_url=http%3A%2F%2Fwww.rubyist.net%2F%7Ematz%2F&wl_g_table=-3">~matz</A><BR>
<A href="http://moonbase.rydia.net/">~mental</A><BR>
<A href="http://techno-weenie.net/">~olson</A><BR>
<A href="http://pragprog.com/pragdave">~pragdave</A><BR>
<A href="http://www.livejournal.com/users/premshree/">~premshree</A><BR>
<A href="http://kronavita.de/chris/blog/">~neukirchen</A><BR>
<A href="http://www.robbyonrails.com/">~robby</A><BR>
<A href="http://www.rousette.org.uk/">~rousette</A><BR>
<A href="http://nubyonrails.com/">~topfunky</A><BR>
<A href="http://www.jvoorhis.com/">~voorhis</A><BR>
<A href="http://onestepback.org/">~weirich</A><BR>
<A href="http://blog.zenspider.com/">~zenspider</A><BR>
        </DIV> 
 <DIV class="sidebarBox">
        <H2 class="sidebarTitle">Syndicate</H2>
        <UL>
            <LI><A href="../index.xml">RSS 2.0</A></LI>
        </UL>
        </DIV> 
 <DIV class="sidebarBox">
        <P>Built upon <A href="http://hobix.com/">Hobix</A></P>
        </DIV> 
<IMG src="../images/redhanded-duck.gif" alt="Type the Duck">
<DIV class="email">Got a story for us? <A href="../mailto:redhanded@hobix.com">E-mail it!</A></DIV>
<DIV class="technorati"><P><A href="http://www.technorati.com/profile/whytheluckystiff">Technorati Profile</A>
<A href="http://www.technorati.com/cosmos/search.html?url=http%3A%2F%2Fredhanded.hobix.com"><BR>
<IMG src="../images/bubble_icon.gif" height="20" width="24" alt="Get Conversations about RedHanded &raquo; sneaking Ruby through the system"></A>
</P>
</DIV>

</DIV>


 <DIV id="blog">
        
<DIV class="entry">
    <H2 class="entryTitle">Open Up Your Wiki and We'll Finish it For You
  <SPAN class="entryPermalink"><A href="../inspect/howToLetAnyoneElseFinishYourWiki.html" title="Permanent link to &ldquo;Open Up Your Wiki and We&#39;ll Finish it For You&rdquo;">#</A></SPAN>
</H2>

<DIV class="entrySection">by <A href="http://whytheluckystiff.net/" title="Visit why&#39;s homepage">why</A> 
  in <A href="../inspect" title="List of entries in the &ldquo;inspect&rdquo; category">inspect</A>
</DIV>

     <DIV class="entryContent"><P>I’m hoping the Freaky Freaky Sandbox will avail me of having to finish anything ever again.  Instead, I can just stop.  Whatever it is, leave it unfinished.  Gently place a sandboxed wiki on it.  And then all of you at home can each add five lines of code and that’s it!</P>


	<P style="text-align:center;"><IMG src="../images/tippytippytepee-1.png" alt=""></P>


	<P>So, let’s get started on this sandboxed scriptable wiki.  Step one, get some embedded Ruby in there.  Here’s how.</P>


<PRE> %w(sandbox rubygems redcloth 
    camping acts_as_versioned).each { |lib| require lib }

 Camping.goes :Tepee

 Tepee::Box = Sandbox.safe
 Tepee::Box.load "erbl.rb" 
</PRE>

	<P>I’m using <A href="http://code.whytheluckystiff.net/svn/camping/trunk/examples/tepee.rb">Tepee</A> as the base.  Sandbox gets loaded first because if you load RubyGems first, it goes bonkers.  So, we’re going to start up a little barebones sandbox and load the ERbLight library, which is written in pure Ruby.  Just to keep it simple.</P>


	<P>Now to swap out the markup processor for a sandbox eval.</P>


<PRE>  def markup str
    @boxx = nil
    begin
      str = Tepee::Box.eval("ERbLight.new(#{str.dump}).result")
    rescue Sandbox::Exception =&gt; @boxx
    end
    RedCloth.new(str, [ :hard_breaks ]).to_html
  end
</PRE>

	<P>And that’s it.  If the sandbox throws an exception, it’ll go in the <CODE>@boxx</CODE> ivar.  It might be better to check for an exception when the user saves the page instead.</P>


	<P>So, this sandbox does <EM>nothing</EM>.  I mean you can do math and string stuff and hashes and whatever, but it’s not that great.  But come back in a few days and I’ll show you some more tricks for the <A href="http://code.whytheluckystiff.net/svn/sandbox/trunk/examples/tippytippytepee/">Tippy Tippy Tepee</A>.</P></DIV> 
</DIV>
<DIV class="entryFooter"> 
    <NOBR>28 Sep 2006</NOBR> at <NOBR>16:35</NOBR>
    <NOSCRIPT></NOSCRIPT>
   | 
    20 comments
</DIV>
</DIV>
<DIV id="comments">


<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>kode</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>28 Sep 2006</NOBR> at <NOBR>17:37</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>well, uh, trippy.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>futago</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>28 Sep 2006</NOBR> at <NOBR>17:48</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>First ‘Tepee’ link is wrong.
Should point to “http://code.whytheluckystiff.net/svn/sandbox/trunk/examples/tippytippytepee/tepee.rb”</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>MenTaLguY</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>28 Sep 2006</NOBR> at <NOBR>17:50</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Awe-some.</P>


	<P>Out of curiousity, how far do you think we are from getting Markaby working in a Sandbox::Safe?</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>MenTaLguY</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>28 Sep 2006</NOBR> at <NOBR>17:58</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Incidentally, I’d like to move the current Sandbox class to something like Sandbox::Full, making Sandbox a module (we’d keep Sandbox.new and Sandbox.safe though).  The rationale is that it would then become safe to introduce e.g. Sandbox::BoxedRef into a safe sandbox (once the import name issue was resolved).</P>


	<P>Any objections/thoughts to that?</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>MenTaLguY</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>28 Sep 2006</NOBR> at <NOBR>18:02</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Ahh… hmm, actually I’d still need to prevent Sandbox.new and Sandbox.safe from getting copied in somehow.  Maybe I’ll stick with a top-level BoxedRef for now…</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>why</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>28 Sep 2006</NOBR> at <NOBR>19:07</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P><STRONG>futago:</STRONG> Oh, good, thanks.</P>


	<P><STRONG>MenTaLguY:</STRONG> Here’s what I was thinking about all that—and it’s exactly the code my hands are puttying up right now.  The Sandbox::Ref class doesn’t need to show up in the sandbox.  (Just like the Sandbox::Exception class doesn’t.)  As long as the reference is somewhere in any sandbox, it won’t get GC’d.</P>


	<P>I like the idea of making Sandbox a module anyway, though.  Sandbox::Full and all that.  And, probably, very soon, we could make it easy for people to keep their own pre-baked sandboxes as classes under that module.</P>


	<P>There’s alot more to discuss, but I think I’d rather wrap up what I’m working on so we can try it out for reals and see.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>FlashHater</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>28 Sep 2006</NOBR> at <NOBR>20:20</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Why won’t Markaby run in a safe-box? Too much metaprogramming-foo in it?</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>MenTaLguY</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>28 Sep 2006</NOBR> at <NOBR>22:10</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P><STRONG>why</STRONG>: Ah!  So, for Sandbox::Ref, you’re thinking of just returning the object boxed in the ref, rather than doing any marshalling at all [unless/until someone outside tries to unbox it]?</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>MenTaLguY</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>28 Sep 2006</NOBR> at <NOBR>22:18</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>FlashHater: I think in principle it could be made to work—it’s all straight Ruby after all.  At minimum right now you’d have to glom it all into a single ruby file, though, since you don’t really want to give <CODE>require</CODE> to a safe-sandbox.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>why</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>28 Sep 2006</NOBR> at <NOBR>22:55</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Some stuff will get marshalled.  Strings and  hashes and arrays and stuff.  All the built-ins.</P>


	<P>Anyway, after some more thinking, I think we’ll need a Ref class inside the box, too.</P>


<PRE> box = Sandbox.new :ref =&gt; MySQL, :import =&gt; :YAML
</PRE>

	<P>So, the <CODE>:ref</CODE> will give the sandbox a proxy class called <CODE>MySQL</CODE>.  You can run any of the methods on the <CODE>MySQL</CODE>, but if it returns anything not referenced in the box, it’ll throw an exception.  Else it gives a boxed ref.</P>


<PRE> &gt;&gt; my = MySQL.init
 =&gt; #&lt;Ref MySQL&gt;
 &gt;&gt; my.query_rows("SELECT * FROM animals")
 =&gt; [['gopher'], ['jellyfish'], ['owl']]
 &gt;&gt; my.query("SELECT * FROM bacons")
 Sandbox::CannotReference: no MySQL::Result
</PRE>

	<P>So, you’d need to do:</P>


<PRE> Sandbox.new :ref =&gt; [MySQL, MySQL::Result]
</PRE>

	<P>This probly sounds like I’m just spouting off ideas, but these ideas really have been baking while I work on stuffing Rails and Camping and Mongrel full of sandboxes.  And yet, they’re dying to be debunked and outlawed.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>J`ey</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>29 Sep 2006</NOBR> at <NOBR>00:39</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>yay! why, this looks fun!</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Dr Nic</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>29 Sep 2006</NOBR> at <NOBR>03:32</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>There are so many fun places to stick a sandbox out on the streets and let the little people play with pure Ruby.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>nil</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>29 Sep 2006</NOBR> at <NOBR>12:08</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>is the issues on the  BSD  of Free resolved?</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>why</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>29 Sep 2006</NOBR> at <NOBR>12:22</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P><STRONG>nil:</STRONG> Yes.  I ended up having the same problems on Linux and the threading patches fixed it all.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>MenTaLguY</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>29 Sep 2006</NOBR> at <NOBR>20:16</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P><STRONG>why</STRONG>: hmm, it seems like I’d probably end up wanting finer-grained control of what to proxy than <CODE>:ref</CODE> would provide.  Either per-method, or be able to proxy something inside as ‘MySQL’ which is totally different outside (so it can do the filtering).</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>why</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>29 Sep 2006</NOBR> at <NOBR>20:31</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Exactly, that’s what you’d do.  If you don’t want the sandbox to access all method of the MySQL class, create a wrapper class as a proxy, with the methods you want.</P>


	<P>Maybe the <CODE>ref</CODE> (or maybe <CODE>link</CODE>) method could rename the reference.</P>


<PRE> class MySQLSafe
   def query(str)
     MySQL.get_some_query_hashes(str)
   end
 end

 box.link :MySQLSafe =&gt; :MySQL
</PRE>

	<P>Roughly.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>MenTaLguY</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>30 Sep 2006</NOBR> at <NOBR>10:43</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Hmm, yeah, that’s roughly in the right neighborhood.  What about calling it <CODE>box.proxy</CODE>?</P>


	<P>If <CODE>box.link</CODE> or <CODE>box.proxy</CODE> or whatever also works for modules, I think it should be sufficient for our other trap/hook/proxy needs as well (hooks can then be spot-applied to classes or eigenclasses via <CODE>include</CODE>).</P>


	<P>One thing we’ll probably need to be careful about is not to proxy methods inherited from <CODE>Object</CODE>, except those overridden by <CODE>MySQLSafe</CODE> or a non-<CODE>Object</CODE> ancestor.  Too easy to have security leaks otherwise.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>MenTaLguY</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>30 Sep 2006</NOBR> at <NOBR>10:53</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Can you go ahead and commit a rough implementation of this?  Renamed proxy classes/modules and conservatively proxying everything that’s not a builtin.  I think this is basically it, and we can file off any rough corners between us as we go.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>alex</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>02 Oct 2006</NOBR> at <NOBR>10:43</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>The sandbox is rockin’.  A question from one of the uninitiated:</P>


	<P>I noticed that some exceptions thrown while evaluating code in the sandbox cause the exception to be raised to the caller of Sandbox#eval, even if the exception is explicitly rescued:</P>


<PRE><CODE>require 'sandbox'
box = Sandbox.new :init =&gt; :all
begin
  box.eval(%{
    $:.unshift *#{$:.inspect}
    require 'fileutils'
    begin
      FileUtils.mkdir_p '/Users/alex/'
    rescue Exception =&gt; ex
      puts "rescue me!" 
    end
  })
rescue =&gt; e
  raise "why have you forsaken me?" 
end
</CODE>
</PRE>

	<P>FileUtils#mkdir_p is supposed to rescue the SystemCallError generated by Dir.mkdir(’/Users’) and Dir.mkdir(’/Users/alex’) if they already exist.  In the Sandbox this exception terminates the call to box.eval and the exception is rescued in the “why have you forsaken me?” fashion, rather than the more popular “rescue me!” manner.  The exception is “File exists – /Users/alex/ (Errno::EEXIST)”.</P>


	<P>Is this the desired behavior?</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>MenTaLguY</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>02 Oct 2006</NOBR> at <NOBR>14:04</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>No.  Hmm, my guess is that Dir.mkdir is retaining a non-sandbox version of Errno::EEXIST someplace.  Hence it wouldn’t descend from Exception in the sandbox, and the rescue Exception wouldn’t catch it.  I’m not sure how this can be addressed.</P></DIV></DIV>
</DIV>


<DIV class="entry">
<FORM name="userComment" method="post" action="/api/comment/inspect/howToLetAnyoneElseFinishYourWiki">
  <DIV class="entryAttrib">
     <DIV class="entryAuthor"><INPUT name="sayor" type="textbox" size="15" maxlength="50"></DIV>
     <DIV id="liveTime" class="entryTime"><NOBR>11 Jul 2010</NOBR> at <NOBR>21:14</NOBR></DIV>
  </DIV>
  <DIV class="entryContentOuter"><DIV class="entryContent">
     <INPUT type="hidden" name="timestamp" value="yopYLare1A">
     <TEXTAREA name="consay" rows="6" cols="50"></TEXTAREA>
     <P><INPUT type="button" name="pleasePreview" value="preview" onclick="liveTextilePreview(document.forms[&#39;userComment&#39;].elements[&#39;consay&#39;], &#39;textilePreview&#39;, &#39;/api/preview&#39;)">
        <INPUT type="submit" name="submit" value="&gt;&gt;">
        <SMALL>* do <A href="../javascript:quickRedReference();">fancy stuff</A> in your comment.</SMALL>
     </P>
     <DIV id="textileWrap"><H4>PREVIEW PANE</H4>
     <DIV id="textilePreview"></DIV>
     </DIV>
     </DIV>
  </DIV></FORM></DIV>
  



        </DIV> 

</DIV>



</DIV>





</BODY></HTML>