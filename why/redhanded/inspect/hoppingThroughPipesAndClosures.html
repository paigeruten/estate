<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0105)redhanded.hobix.com/inspect/hoppingThroughPipesAndClosures.html -->
<HTML xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><HEAD><META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--<BASE href="http://redhanded.hobix.com.wstub.archive.org/inspect/hoppingThroughPipesAndClosures.html">--><BASE href=".">


<TITLE>RedHanded » Hopping Through Pipes and Closures</TITLE>
<LINK rel="shortcut icon" href="../favicon.ico" type="image/vnd.microsoft.icon" />
<LINK rel="icon" href="../favicon.ico" type="image/vnd.microsoft.icon" />
<META http-equiv="Pragma" content="no-cache">
<META http-equiv="Expires" content="-1">




<STYLE type="text/css">
 @import "../site.css"; 
</STYLE>
</HEAD><BODY>

<DIV id="page">

<DIV id="hoodwinkd">
  <A href="http://hoodwinkd.hobix.com/"><SPAN>hoodwink.d enhanced</SPAN></A>

</DIV>
<DIV id="buttons">
<DL class="tab">
  <DT><A title="Syndicate this Site" href="index.xml">RSS</A></DT>
  <DD><A title="Syndicate this Site" href="index.xml">2.0</A></DD>
</DL>
<DL class="tab xhtml">
  <DT><A title="Validate this Site" href="http://validator.w3.org/check?uri=http://redhanded.hobix.com/">XHTML</A></DT>
  <DD><A title="Validate this Site" href="http://validator.w3.org/check?uri=http://redhanded.hobix.com/">1.0</A></DD>
</DL>
</DIV>
<H1 class="title"><A href="../"><IMG src="../images/redhanded.gif" alt="RedHanded"></A></H1>
<DIV id="banner">
  <DIV class="tagline">sneaking Ruby through the system</DIV>
  <DIV class="nav"><A href="../5.gets/">5.gets</A> | <A href="../bits/">bits</A> | 
    <A href="../inspect/">inspect</A> | <A href="../cult/">the cult</A> | <A href="../-h/">-h</A></DIV>
</DIV>


<DIV id="content">
<DIV id="sidebar">
<P>New to RedHanded? <A href="../-h/pardonAndWelcome.html">About our sections.</A></P>

<DIV class="sidebarBox">
<H2 class="sidebarTitle">Archive</H2>
<UL>

    <LI><A href="../2004/12/">December 2004</A></LI>

    <LI><A href="../2005/01/">January 2005</A></LI>

    <LI><A href="../2005/02/">February 2005</A></LI>

    <LI><A href="../2005/03/">March 2005</A></LI>

    <LI><A href="../2005/04/">April 2005</A></LI>

    <LI><A href="../2005/05/">May 2005</A></LI>

    <LI><A href="../2005/06/">June 2005</A></LI>

    <LI><A href="../2005/07/">July 2005</A></LI>

    <LI><A href="../2005/08/">August 2005</A></LI>

    <LI><A href="../2005/09/">September 2005</A></LI>

    <LI><A href="../2005/10/">October 2005</A></LI>

    <LI><A href="../2005/11/">November 2005</A></LI>

    <LI><A href="../2005/12/">December 2005</A></LI>

    <LI><A href="../2006/01/">January 2006</A></LI>

    <LI><A href="../2006/02/">February 2006</A></LI>

    <LI><A href="../2006/03/">March 2006</A></LI>

    <LI><A href="../2006/04/">April 2006</A></LI>

    <LI><A href="../2006/05/">May 2006</A></LI>

    <LI><A href="../2006/06/">June 2006</A></LI>

    <LI><A href="../2006/07/">July 2006</A></LI>

    <LI><A href="../2006/08/">August 2006</A></LI>

    <LI><A href="../2006/09/">September 2006</A></LI>

    <LI><A href="../2006/10/">October 2006</A></LI>

    <LI><A href="../2006/11/">November 2006</A></LI>

    <LI><A href="../2006/12/">December 2006</A></LI>

    <LI><A href="../2007/01/">January 2007</A></LI>

    <LI><A href="../2007/02/">February 2007</A></LI>

    <LI><A href="../2007/03/">March 2007</A></LI>

    <LI><A href="../2007/04/">April 2007</A></LI>

    <LI><A href="../2007/05/">May 2007</A></LI>

</UL>
</DIV>

<P><A href="http://www.pragmaticprogrammer.com/titles/ruby/index.html"><IMG src="../images/prag-ruby-book.jpg" alt="PickAxe II"></A><BR>
<A href="http://www.pragmaticprogrammer.com/titles/ruby/index.html">Get your copy of <I>Programming Ruby</I>!</A></P>

 <DIV class="sidebarBox">
        <H2 class="sidebarTitle">Links</H2>
        <A href="http://technorati.com/tags/ruby">@technorati</A><BR>
<A href="http://del.icio.us/tag/ruby">@del.icio.us</A><BR>
<A href="http://www.flickr.com/photos/tags/ruby">@flickr</A><BR>
<A href="http://www.artima.com/articles/index.jsp?topic=ruby">@artima</A><BR>
<A href="http://blog.caboo.se/">@caboo</A><BR>
<A href="http://www.oreillynet.com/ruby">@oreilly</A><BR>
<A href="http://ruby-lang.org/">ruby</A><BR>
<A href="http://ruby-doc.org/">-&gt; docs</A><BR>
<A href="http://rubyforge.org/">-&gt; wares</A><BR>
<A href="http://rubygarden.org/ruby/">-&gt; wiki</A><BR>
<A href="http://www.sitepoint.com/forums/forumdisplay.php?f=227">-&gt; forum</A><BR>
<A href="http://www.rubyquiz.com/">-&gt; quizzes</A><BR>
<A href="http://planetruby.0x42.net/">-&gt; planet</A><BR>
<A href="http://meme.b9.com/cdates.html?channel=ruby-lang">-&gt; irc</A><BR>
<A href="http://www.rubyweeklynews.org/">rubyweeklynews</A><BR>
<A href="http://weblog.rubyonrails.com/">rails</A><BR>
<A href="http://wiki.rubyonrails.org/">-&gt; wiki</A><BR>
<A href="http://www.planetrubyonrails.org/">-&gt; planet</A><BR>
<A href="http://thesaq.com/rubyonrails/">-&gt; irc</A><BR>
<A href="http://anarchaia.org/">%anarchaia</A><BR>
<A href="http://project.ioni.st/">%projectionist</A><BR>
<A href="http://pugs.blogs.com/">~audreyt</A><BR>
<A href="http://dablog.rubypal.com/">~black</A><BR>
<A href="http://www.jamesbritt.com/">~britt</A><BR>
<A href="http://www.jamisbuck.org/jamis/">~buck</A><BR>
<A href="http://tomcopeland.blogs.com/juniordeveloper/">~copeland</A><BR>
<A href="http://eigenclass.org/">~fernandez</A><BR>
<A href="http://www.chadfowler.com/">~fowler</A><BR>
<A href="http://www.loudthinking.com/">~hansson</A><BR>
<A href="http://blog.segment7.net/">~hodel</A><BR>
<A href="http://slash7.com/">~hoy/7</A><BR>
<A href="http://fhwang.net/">~hwang</A><BR>
<A href="http://blog.leetsoft.com/">~luetke</A><BR>
<A href="http://www.worldlingo.com/wl/translate?wl_lp=JA-en&wl_glossary=gl1&wl_fl=3&wl_rurl=http%3A%2F%2Fwww.rubyist.net%2F%7Ematz%2F&wl_url=http%3A%2F%2Fwww.rubyist.net%2F%7Ematz%2F&wl_g_table=-3">~matz</A><BR>
<A href="http://moonbase.rydia.net/">~mental</A><BR>
<A href="http://techno-weenie.net/">~olson</A><BR>
<A href="http://pragprog.com/pragdave">~pragdave</A><BR>
<A href="http://www.livejournal.com/users/premshree/">~premshree</A><BR>
<A href="http://kronavita.de/chris/blog/">~neukirchen</A><BR>
<A href="http://www.robbyonrails.com/">~robby</A><BR>
<A href="http://www.rousette.org.uk/">~rousette</A><BR>
<A href="http://nubyonrails.com/">~topfunky</A><BR>
<A href="http://www.jvoorhis.com/">~voorhis</A><BR>
<A href="http://onestepback.org/">~weirich</A><BR>
<A href="http://blog.zenspider.com/">~zenspider</A><BR>
        </DIV> 
 <DIV class="sidebarBox">
        <H2 class="sidebarTitle">Syndicate</H2>
        <UL>
            <LI><A href="../index.xml">RSS 2.0</A></LI>
        </UL>
        </DIV> 
 <DIV class="sidebarBox">
        <P>Built upon <A href="http://hobix.com/">Hobix</A></P>
        </DIV> 
<IMG src="../images/redhanded-duck.gif" alt="Type the Duck">
<DIV class="email">Got a story for us? <A href="../mailto:redhanded@hobix.com">E-mail it!</A></DIV>
<DIV class="technorati"><P><A href="http://www.technorati.com/profile/whytheluckystiff">Technorati Profile</A>
<A href="http://www.technorati.com/cosmos/search.html?url=http%3A%2F%2Fredhanded.hobix.com"><BR>
<IMG src="../images/bubble_icon.gif" height="20" width="24" alt="Get Conversations about RedHanded &raquo; sneaking Ruby through the system"></A>
</P>
</DIV>

</DIV>


 <DIV id="blog">
        
<DIV class="entry">
    <H2 class="entryTitle">Hopping Through Pipes and Closures
  <SPAN class="entryPermalink"><A href="../inspect/hoppingThroughPipesAndClosures.html" title="Permanent link to &ldquo;Hopping Through Pipes and Closures&rdquo;">#</A></SPAN>
</H2>

<DIV class="entrySection">by <A href="http://whytheluckystiff.net/" title="Visit why&#39;s homepage">why</A> 
  in <A href="../inspect" title="List of entries in the &ldquo;inspect&rdquo; category">inspect</A>
</DIV>

     <DIV class="entryContent"><P>Again, just an example of Ruby’s flexibility.</P>


<PRE> class IO
   def | proc
     proc[self]
   end
 end
</PRE>

	<P>Pass a File or Socket through a chain of procs with a pipe!</P>


<PRE> wc = proc { |io| io.inject(0) { |i, line| i + 1 } }
</PRE>

	<P>Like the above proc, which counts lines in a file.</P>


<PRE> count = open("/var/log/messages") | wc
</PRE>

	<P>Now, if you want to keep going and get these procs all chained together into a nice series of pipes and ongoing IO, see:</P>


<PRE> wc = proc { |io| IO[io.inject(0) { |i, line| i + 1 }] }
 grep = proc { |exp| proc { |io| IO[io.grep(exp)] } }

 count = open("/var/log/messages") | grep[/root/] | wc
 p count.read
</PRE>

	<P>Which can be done in a myriad of fashions, but I chose to use <CODE>StringIO</CODE> in my script: <A href="http://whytheluckystiff.net/ruby/ruby-pipe.rb">ruby-pipe.rb</A>.  What fun. See <A href="http://blogs.pragprog.com/cgi-bin/pragdave.cgi/Tech/Ruby/ToProc.rdoc">Symbol.to_proc</A> for a like kind of wonderment.</P></DIV> 
</DIV>
<DIV class="entryFooter"> 
    <NOBR>19 Nov 2005</NOBR> at <NOBR>13:56</NOBR>
    <NOSCRIPT></NOSCRIPT>
   | 
    28 comments
</DIV>
</DIV>
<DIV id="comments">


<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>MenTaLguY</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>19 Nov 2005</NOBR> at <NOBR>14:22</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Have you been using Haskell on the quiet?  Because, I swear, it looks like you have.</P>


	<P>You are writing monadic combinators in Ruby, I mean!  And currying lambdas!</P>


	<P>Sneaky of you, calling your lambdas “procs”, but don’t think we wouldn’t notice…</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>MenTaLguY</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>19 Nov 2005</NOBR> at <NOBR>14:57</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>(after checking out the <CODE>Symbol#to_proc</CODE> hack)</P>


	<P>Ah, goes to show—inside every imperative language there’s a plain functional language screaming to get out.  <CODE>names.map(&amp;:upcase)</CODE> is the sort of thing you take for granted in functional-land.</P>


	<P>Functional languages  FLIP OUT  and curry functions  ALL THE TIME , man.  It’s the  REAL ULTIMATE POWER .</P>


	<P>It’d be interesting to collect all these “functional-style” Ruby hacks in one place…</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Danno</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>19 Nov 2005</NOBR> at <NOBR>17:21</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>An internet cookie to the man that brings me Prolog’s head on a Ruby fox’s tail!</P>


	<P>What’s really nice though, about all this functionalityness in Ruby, is that the syntax for using it is as good, if not better than pure functional languages!</P>


	<P>It’s just too bad that the result has to be a StringIO object.  Not sure that feels natural to me…</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>why</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>19 Nov 2005</NOBR> at <NOBR>17:40</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P><STRONG>MenTaLguY</STRONG>: That’s exactly what I was thinking.  The whole wrapper syntax is awesome for explaining monads, but too crufty to really use when loafing around the house.  But this could work…</P>


	<P><STRONG>Danno</STRONG>: Yeah, it does feel odd.  I guess do a String pipe.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>cuz</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>19 Nov 2005</NOBR> at <NOBR>19:03</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Stuff like this might actually get the FP guys’ attention away from Python and onto Ruby.  That’d be a group of smart programmers who could make some nice contributions to the Ruby community…</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>cuz</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>19 Nov 2005</NOBR> at <NOBR>19:04</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Makes the shell scripter in me happy too :O)</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Danno</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>19 Nov 2005</NOBR> at <NOBR>19:31</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>My first instinct is to just have grep and wc extend the object they return with the Piping module.</P>


	<P>There seems to be a problem with extending an instance of a Fixnum though.</P>


	<P>I’m asking around on #ruby-lang for a solution.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>murphy</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>19 Nov 2005</NOBR> at <NOBR>19:39</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>I really love all those neat syntax tricks, especially Symbol#to_proc, which would be great for Ruby 2.</P>


	<P>But this example – I don’t know if it really proves that such hacks are usefull. Ruby has ”.” for ”|”; compare the above to the equivalent:</P>


	<PRE><CODE>p open("/var/log/messages").grep(/root/).size</CODE></PRE>


	<P>which is much more readable for Ruby folks.</P>


	<P>Someone started creating a shell using Ruby syntax (don’t remember the name) – this would be the reverse idea…</P>


	<P>As often, a really nice hack may be cool, but not really “useful” for real problems. Anyway, continue! This is the Fun of Ruby, so it is “useful” in a much deeper sense.</P>


	<P>btw: what is this?</P>


	<PRE><CODE>IO[...]</CODE></PRE>


	<P>Is this Ruby 1.9?</P>


	<P>@FP: I think Ruby has one real disadvantage over Haskell ‘n friends: the dynamic function definition (if you give less parameters than the function needs, it returns a function) is not implementable in Ruby. At least I don’t think it is possible with pure Ruby and with acceptable performance.</P>


	<P>Whoever proves the opposite is my hero :D</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Danno</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>19 Nov 2005</NOBR> at <NOBR>20:00</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Alrighty, here’s what me ‘n’ the boys on #ruby-lang came up with.</P>


	<P>Solution to singleton-classes is to just extend the class itself.</P>


I really like the Piping[] method, sorta like “Piping hot bowl of awesome comin’ right up!” 
<PRE><CODE>
module Piping
   def | proc 
        proc.call self
    end

    def self.[](obj)
        if obj.class.respond_to? :new
            obj.extend(Piping)
        else
       obj.class.extend(Piping)
        end
        obj
    end
end

class IO
  include Piping
end

wc = proc { |io| Piping[io.inject(0) { |i, line| i += 1 }] }
grep = proc { |exp| proc { |io| Piping[io.grep(exp)] } }

count = open("ruby-pipe.rb") | grep[/io/] | wc
p count

</CODE></PRE><CODE>
</CODE>

	<P>murph: 
1) IO[] was a method that why added to the IO class.</P>


	<P>2) I’m tempted to take that challenge.  Just one question: How do Haskell ‘n Friends handle the situation when there’s more than one method you could return a curried version of?</P>


	<P>Specifically, I’m trying to think of how to handle optional parameters.  And I’m relatively sure that in functional languages, you can have functions with differing numbers of arguments.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>flgr</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>19 Nov 2005</NOBR> at <NOBR>20:23</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>It’s great to see so many people like Symbol#to_proc, but _why, did you really have to use += instead of + in that inject block?</P>


	<P>I fear more and more people are not understanding what inject actually does and what it should be used for. Don’t modify in the block or you can just as well use each—just go from an existing state to a new one and let inject do the work for you.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>why</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>19 Nov 2005</NOBR> at <NOBR>21:34</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P><STRONG>flgr</STRONG>: Missed that, thank you.</P>


	<P><STRONG>murphy</STRONG>: Yeah, true.</P>


	<P><STRONG>mental</STRONG>: After some thought… please forgive the word <EM>crufty</EM>.  I’ve been up all day.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>&lt;|:{</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>20 Nov 2005</NOBR> at <NOBR>00:14</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Bravo!  The ruby shell folks should incorporate this immediately.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>chris2</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>20 Nov 2005</NOBR> at <NOBR>05:42</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Hmm, I did something like that in 2004, <A href="http://kronavita.de/chris/data/pipeline_rdoc.html">Object-oriented Pipelines</A>.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Dave Burt</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>20 Nov 2005</NOBR> at <NOBR>09:46</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Murphy said: “I think Ruby has one real disadvantage over Haskell ‘n friends: the dynamic function definition (if you give less parameters than the function needs, it returns a function) is not implementable in Ruby.”</P>


<PRE><CODE>
# curry :: ((a, b) -&gt; c) -&gt; a -&gt; b -&gt; c
curry = proc {|f| proc {|x| proc {|y| f[x, y] } } }
</CODE></PRE>

	<P>You’ll find even more interesting Ruby-currying in the ruby-talk archives.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>MenTaLguY</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>20 Nov 2005</NOBR> at <NOBR>12:05</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P><STRONG>why</STRONG>: Well, the thing is, in Ruby, it <EM>is</EM> crufty-feeling.  Goes against the grain.  So I think <EM>crufty</EM> is a perfectly fitting word.</P>


	<P>I’ve got to stick with <CODE>pass</CODE> and <CODE>wrap</CODE>, though, for pedagogical reasons (at least to start with), because they are those what make monads monads.</P>


	<P>Jumping right into combinators as you’ve done is actually <EM>useful</EM>, but it’s a few stages removed from the basic monad concept.</P>


	<P>Also, since Ruby is so <EM>laissez-faire</EM> about types, it’s hard to avoid convenient shortcuts that take you out of monad-land.  Working on the Monads-in-Ruby series, I’m beginning to feel like using monads properly in Ruby requires a discipline that none of us have.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>MenTaLguY</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>20 Nov 2005</NOBR> at <NOBR>12:08</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P><STRONG>why</STRONG>: Oh, and for what it’s worth, even in Haskell, most interesting uses of monads mainly involve combinators.  <CODE>&gt;&gt;=</CODE> and <CODE>return</CODE> are the foundations for stringing things together, not the meat and potatoes.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>MenTaLguY</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>20 Nov 2005</NOBR> at <NOBR>12:09</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>(hence the popularity of <CODE>liftM</CODE> and friends, which hoist everyday functions into combinators in a particular monad)</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>olleolleolle</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>20 Nov 2005</NOBR> at <NOBR>17:27</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>You folks are reading my little mind, like a picture-book. The current FP craze is getting to all of us.</P>


	<P>I just read David Mertz’ <A href="http://www-128.ibm.com/developerworks/edu/os-dw-linuxhask-i.html">Beginning Haskell</A> tutorial. (Free signup req’d. Oh well.) And that curry-in-Haskell statement was there, too. (Like <EM>dejà-new</EM> – something I have seen before, recently.)</P>


	<P>I sat down with coloring pens to add syntax highlighting and some markup to add a little pedagogy to the raw Haskell source. Sometimes, I had to color as little as one character, to isolate something meaningful. FP takes a deft hand.</P>


	<P><STRONG>Mental</STRONG>, <STRONG>why</STRONG>, <STRONG>Dave Burt</STRONG>, (and the tail of the list of commenters) <EM>thanks</EM> for the explanation-informercials on Haskell, Raskell et al.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Adam Sanderson</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>21 Nov 2005</NOBR> at <NOBR>11:07</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>It’s funny, when you’re looking at something like this you also pick up little things, I didn’t realize a proc could be accessed with [].</P>


	<P>Now I just have to think of why I’d want to use the monadic bits.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Curried  Chicken</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>22 Nov 2005</NOBR> at <NOBR>13:18</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Dave Burt said:</P>


	<P>curry = proc {|f| proc {|x| proc {|y| f[x, y] } } }</P>


	<P>So how does one go about calling this?  I’m thinking that it should take a proc as an argument and that proc should take an argument:</P>


	<P>curry[proc{|f| puts f }]</P>


	<P>but that didn’t do anything.  So how exactly would I use the above curry proc?</P>


	<P> BTW : What’s a good (readable) source of info on Functional Programming concepts (preferrably using Ruby for the examples:) ?  Is there some sort of Poignant Guide to FP?  Perhaps _why would like to write a Functionally Poignant Guide to Ruby?</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>why</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>22 Nov 2005</NOBR> at <NOBR>14:40</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P><STRONG>Curried Chicken</STRONG>: If you taste as deeply as you are nested, then please stay for lunch, I insist.</P>


	<P>Well, one use of a proc like the above would be as a kind of factory for procs:</P>


<PRE> oper = proc do |op|
   proc do |x, y|
     x.method(op).call(y)
   end
 end

 add = oper[:+]
 puts add[1,2]  #=&gt; 3

 sub = oper[:-]
 puts sub[2,1]  #=&gt; 1
</PRE>

	<P>Basically, you need to ask if a certain bit of data would be better expressed as a function (<CODE>f(x)</CODE>) rather than just the data (<CODE>y</CODE>).</P>


	<P>Like how <CODE>4.years</CODE> should probably return a function so that <CODE>Time.now - 4.years</CODE> would work right.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Dave Burt</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>22 Nov 2005</NOBR> at <NOBR>18:07</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Chicken,</P>


	<P>Close. The input function needs to take 2 arguments.</P>


	<P>That curry proc is kinda like Haskell’s curry function: it converts a function that takes 2 arguments into a function that takes one argument, returning a function that takes the second argument which finally returns the result. Example time.</P>


<PRE><CODE>
add = proc {|x, y| x + y }
add[1, 2] #=&gt; 3
curried_add = curry[add]
add_three = curried_add[3]
add_three[4] #=&gt; 7
</CODE></PRE></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Curried Chicken</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>22 Nov 2005</NOBR> at <NOBR>18:32</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Ah, thanks Dave and _why.  Now I’m much less chicken of currying and but I have one beef :)  what is the usefulness of of curry?  I mean it’s nice and all that I don’t need as many arguments, but still.</P>


	<P>I await the Poignant Guide to Functional Ruby.  I’ve been wanting to learn FP for some time now, but everytime I start the OCaml tutorial I’m put off by the syntax.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>MenTaLguY</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>22 Nov 2005</NOBR> at <NOBR>19:34</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>I’m considering doing such a guide, actually.  The Monads in Ruby thing is merely a dress rehearsal.  But no promises yet.</P>


	<P>As for currying, it’s a useful way of building little helper functions on the spot.  It basically amounts to applying a function part-way, leaving the remainder of the arguments dangling for later.  You do it all the time without realizing (more on that in a moment).</P>


	<P>It is based on Haskell Curry’s (yeah.) insight that:</P>


<PRE><CODE>lambda { |a, b, c| ... }</CODE></PRE>

	<P>Means essentially the same thing as (for example):</P>


<PRE><CODE>lambda { |a| lambda { |b| lambda { |c| ... } } }</CODE></PRE>

	<P>This means you can (conceptually) break up a function’s arguments however you like.  Apply a three-argument function to one argument?  You get a two-argument function.  Apply a three-argument function to two arguments, you get a one-argument function.</P>


	<P>Since Ruby won’t curry for you automatically, you can do it explicitly with lambdas—say you want to curry two arguments into a three-argument function.</P>


<PRE><CODE>lambda { |c| zoog( 1, 2, c ) }</CODE></PRE>

	<P>See?  Two arguments curried in, one argument still dangling.</P>


	<P>What use is this?  Well, as I said you’ve probably done a lot of currying without realizing—many of the simple things people do with blocks amount to currying.</P>


	<P>Look, we are currying:</P>


<PRE><CODE>
blahs.map do |c|
  zoog( 1, 2, c )
end
</CODE></PRE>

	<P>or more explicitly:</P>


<PRE><CODE>
blahs.map &amp;lambda { |c| zoog( 1, 2, c ) }
</CODE></PRE>

	<P>The thing about Functional Programming is that you are already doing most of it.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Trejkaz</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>22 Nov 2005</NOBR> at <NOBR>19:50</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>A shell in Ruby syntax?  You might be thinking of <A href="http://rubyforge.org/projects/rush">Rush</A>.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Dave Burt</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>23 Nov 2005</NOBR> at <NOBR>08:36</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>My (less helpful) contribution is only a direct port of bits of Haskell’s Standard Prelude. And it’s not useful in Ruby, except as food for thought. This is mostly because Ruby is not a strictly functional language, nor is it typed as tightly as Haskell, and Ruby offers its own ways to do what you’d use curry for in Haskell. Like Mental says: you’re already doing functional programming when you use Ruby’s blocks; Ruby’s procs are first-class functions. Looking at features of functional languages can provide new ways of looking at Ruby.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>kig</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>23 Nov 2005</NOBR> at <NOBR>13:17</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><PRE><CODE>
class Fun &lt; Proc
  def call(*args)
    if args.size &lt; arity.abs and arity != -1
      Fun.new{|*a| call(*(args+a)) }
    else
      super
    end
  end
  alias_method :[], :call
end

def fun &amp;block
  Fun.new &amp;block
end

f = fun{|a, b, c| a * b / c }

f[10, 20, 30] == f[10][20][30]
#=&gt; true
</CODE></PRE></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>rue</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>27 Nov 2005</NOBR> at <NOBR>23:50</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>rush pipes will work a bit differently though they actually do override |, simply because the domain is a bit different.</P></DIV></DIV>
</DIV>


  <DIV class="entry">
    <P><SMALL>Comments are closed for this entry.</SMALL></P>
  



        </DIV> 

</DIV>



</DIV>





</DIV></BODY></HTML>