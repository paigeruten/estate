<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0092)redhanded.hobix.com/inspect/curryingWithArity.html -->
<HTML xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><HEAD><META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--<BASE href="http://redhanded.hobix.com.wstub.archive.org/inspect/curryingWithArity.html">--><BASE href=".">


<TITLE>RedHanded » Arity Makes Good Curry</TITLE>
<LINK rel="shortcut icon" href="../favicon.ico" type="image/vnd.microsoft.icon" />
<LINK rel="icon" href="../favicon.ico" type="image/vnd.microsoft.icon" />
<META http-equiv="Pragma" content="no-cache">
<META http-equiv="Expires" content="-1">




<STYLE type="text/css">
 @import "../site.css"; 
</STYLE>
</HEAD><BODY>

<DIV id="page">

<DIV id="hoodwinkd">
  <A href="http://hoodwinkd.hobix.com/"><SPAN>hoodwink.d enhanced</SPAN></A>

</DIV>
<DIV id="buttons">
<DL class="tab">
  <DT><A title="Syndicate this Site" href="index.xml">RSS</A></DT>
  <DD><A title="Syndicate this Site" href="index.xml">2.0</A></DD>
</DL>
<DL class="tab xhtml">
  <DT><A title="Validate this Site" href="http://validator.w3.org/check?uri=http://redhanded.hobix.com/">XHTML</A></DT>
  <DD><A title="Validate this Site" href="http://validator.w3.org/check?uri=http://redhanded.hobix.com/">1.0</A></DD>
</DL>
</DIV>
<H1 class="title"><A href="../"><IMG src="../images/redhanded.gif" alt="RedHanded"></A></H1>
<DIV id="banner">
  <DIV class="tagline">sneaking Ruby through the system</DIV>
  <DIV class="nav"><A href="../5.gets/">5.gets</A> | <A href="../bits/">bits</A> | 
    <A href="../inspect/">inspect</A> | <A href="../cult/">the cult</A> | <A href="../-h/">-h</A></DIV>
</DIV>


<DIV id="content">
<DIV id="sidebar">
<P>New to RedHanded? <A href="../-h/pardonAndWelcome.html">About our sections.</A></P>

<DIV class="sidebarBox">
<H2 class="sidebarTitle">Archive</H2>
<UL>

    <LI><A href="../2004/12/">December 2004</A></LI>

    <LI><A href="../2005/01/">January 2005</A></LI>

    <LI><A href="../2005/02/">February 2005</A></LI>

    <LI><A href="../2005/03/">March 2005</A></LI>

    <LI><A href="../2005/04/">April 2005</A></LI>

    <LI><A href="../2005/05/">May 2005</A></LI>

    <LI><A href="../2005/06/">June 2005</A></LI>

    <LI><A href="../2005/07/">July 2005</A></LI>

    <LI><A href="../2005/08/">August 2005</A></LI>

    <LI><A href="../2005/09/">September 2005</A></LI>

    <LI><A href="../2005/10/">October 2005</A></LI>

    <LI><A href="../2005/11/">November 2005</A></LI>

    <LI><A href="../2005/12/">December 2005</A></LI>

    <LI><A href="../2006/01/">January 2006</A></LI>

    <LI><A href="../2006/02/">February 2006</A></LI>

    <LI><A href="../2006/03/">March 2006</A></LI>

    <LI><A href="../2006/04/">April 2006</A></LI>

    <LI><A href="../2006/05/">May 2006</A></LI>

    <LI><A href="../2006/06/">June 2006</A></LI>

    <LI><A href="../2006/07/">July 2006</A></LI>

    <LI><A href="../2006/08/">August 2006</A></LI>

    <LI><A href="../2006/09/">September 2006</A></LI>

    <LI><A href="../2006/10/">October 2006</A></LI>

    <LI><A href="../2006/11/">November 2006</A></LI>

    <LI><A href="../2006/12/">December 2006</A></LI>

    <LI><A href="../2007/01/">January 2007</A></LI>

    <LI><A href="../2007/02/">February 2007</A></LI>

    <LI><A href="../2007/03/">March 2007</A></LI>

    <LI><A href="../2007/04/">April 2007</A></LI>

    <LI><A href="../2007/05/">May 2007</A></LI>

</UL>
</DIV>

<P><A href="http://www.pragmaticprogrammer.com/titles/ruby/index.html"><IMG src="../images/prag-ruby-book.jpg" alt="PickAxe II"></A><BR>
<A href="http://www.pragmaticprogrammer.com/titles/ruby/index.html">Get your copy of <I>Programming Ruby</I>!</A></P>

 <DIV class="sidebarBox">
        <H2 class="sidebarTitle">Links</H2>
        <A href="http://technorati.com/tags/ruby">@technorati</A><BR>
<A href="http://del.icio.us/tag/ruby">@del.icio.us</A><BR>
<A href="http://www.flickr.com/photos/tags/ruby">@flickr</A><BR>
<A href="http://www.artima.com/articles/index.jsp?topic=ruby">@artima</A><BR>
<A href="http://blog.caboo.se/">@caboo</A><BR>
<A href="http://www.oreillynet.com/ruby">@oreilly</A><BR>
<A href="http://ruby-lang.org/">ruby</A><BR>
<A href="http://ruby-doc.org/">-&gt; docs</A><BR>
<A href="http://rubyforge.org/">-&gt; wares</A><BR>
<A href="http://rubygarden.org/ruby/">-&gt; wiki</A><BR>
<A href="http://www.sitepoint.com/forums/forumdisplay.php?f=227">-&gt; forum</A><BR>
<A href="http://www.rubyquiz.com/">-&gt; quizzes</A><BR>
<A href="http://planetruby.0x42.net/">-&gt; planet</A><BR>
<A href="http://meme.b9.com/cdates.html?channel=ruby-lang">-&gt; irc</A><BR>
<A href="http://www.rubyweeklynews.org/">rubyweeklynews</A><BR>
<A href="http://weblog.rubyonrails.com/">rails</A><BR>
<A href="http://wiki.rubyonrails.org/">-&gt; wiki</A><BR>
<A href="http://www.planetrubyonrails.org/">-&gt; planet</A><BR>
<A href="http://thesaq.com/rubyonrails/">-&gt; irc</A><BR>
<A href="http://anarchaia.org/">%anarchaia</A><BR>
<A href="http://project.ioni.st/">%projectionist</A><BR>
<A href="http://pugs.blogs.com/">~audreyt</A><BR>
<A href="http://dablog.rubypal.com/">~black</A><BR>
<A href="http://www.jamesbritt.com/">~britt</A><BR>
<A href="http://www.jamisbuck.org/jamis/">~buck</A><BR>
<A href="http://tomcopeland.blogs.com/juniordeveloper/">~copeland</A><BR>
<A href="http://eigenclass.org/">~fernandez</A><BR>
<A href="http://www.chadfowler.com/">~fowler</A><BR>
<A href="http://www.loudthinking.com/">~hansson</A><BR>
<A href="http://blog.segment7.net/">~hodel</A><BR>
<A href="http://slash7.com/">~hoy/7</A><BR>
<A href="http://fhwang.net/">~hwang</A><BR>
<A href="http://blog.leetsoft.com/">~luetke</A><BR>
<A href="http://www.worldlingo.com/wl/translate?wl_lp=JA-en&wl_glossary=gl1&wl_fl=3&wl_rurl=http%3A%2F%2Fwww.rubyist.net%2F%7Ematz%2F&wl_url=http%3A%2F%2Fwww.rubyist.net%2F%7Ematz%2F&wl_g_table=-3">~matz</A><BR>
<A href="http://moonbase.rydia.net/">~mental</A><BR>
<A href="http://techno-weenie.net/">~olson</A><BR>
<A href="http://pragprog.com/pragdave">~pragdave</A><BR>
<A href="http://www.livejournal.com/users/premshree/">~premshree</A><BR>
<A href="http://kronavita.de/chris/blog/">~neukirchen</A><BR>
<A href="http://www.robbyonrails.com/">~robby</A><BR>
<A href="http://www.rousette.org.uk/">~rousette</A><BR>
<A href="http://nubyonrails.com/">~topfunky</A><BR>
<A href="http://www.jvoorhis.com/">~voorhis</A><BR>
<A href="http://onestepback.org/">~weirich</A><BR>
<A href="http://blog.zenspider.com/">~zenspider</A><BR>
        </DIV> 
 <DIV class="sidebarBox">
        <H2 class="sidebarTitle">Syndicate</H2>
        <UL>
            <LI><A href="../index.xml">RSS 2.0</A></LI>
        </UL>
        </DIV> 
 <DIV class="sidebarBox">
        <P>Built upon <A href="http://hobix.com/">Hobix</A></P>
        </DIV> 
<IMG src="../images/redhanded-duck.gif" alt="Type the Duck">
<DIV class="email">Got a story for us? <A href="../mailto:redhanded@hobix.com">E-mail it!</A></DIV>
<DIV class="technorati"><P><A href="http://www.technorati.com/profile/whytheluckystiff">Technorati Profile</A>
<A href="http://www.technorati.com/cosmos/search.html?url=http%3A%2F%2Fredhanded.hobix.com"><BR>
<IMG src="../images/bubble_icon.gif" height="20" width="24" alt="Get Conversations about RedHanded &raquo; sneaking Ruby through the system"></A>
</P>
</DIV>

</DIV>


 <DIV id="blog">
        
<DIV class="entry">
    <H2 class="entryTitle">Arity Makes Good Curry
  <SPAN class="entryPermalink"><A href="../inspect/curryingWithArity.html" title="Permanent link to &ldquo;Arity Makes Good Curry&rdquo;">#</A></SPAN>
</H2>

<DIV class="entrySection">by <A href="http://whytheluckystiff.net/" title="Visit why&#39;s homepage">why</A> 
  in <A href="../inspect" title="List of entries in the &ldquo;inspect&rdquo; category">inspect</A>
</DIV>

     <DIV class="entryContent"><P>kig just dropped this snip in the comments of the <A href="../inspect/hoppingThroughPipesAndClosures.html#comments">pipes</A> discussion, which had morphed into a discussion about functional programming.</P>


<PRE> class Fun &lt; Proc
   def call(*args)
     if args.size &lt; arity.abs and arity != -1
       Fun.new{|*a| call(*(args+a)) }
     else
       super
     end
   end
   alias_method :[], :call
 end

 def fun &amp;block
   Fun.new &amp;block
 end

 f = fun{|a, b, c| a * b / c }

 f[10, 20, 30] == f[10][20][30]
 #=&gt; true
</PRE>

	<P>You can sort of curry methods with this, like so:</P>


<PRE> class Turtle
   def draw *args
     fun { |x, y| ... }.call(*args)
   end
 end
</PRE>

	<P>But you will need to use the bracket syntax on the function returned by the method.</P></DIV> 
</DIV>
<DIV class="entryFooter"> 
    <NOBR>23 Nov 2005</NOBR> at <NOBR>14:19</NOBR>
    <NOSCRIPT></NOSCRIPT>
   | 
    17 comments
</DIV>
</DIV>
<DIV id="comments">


<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Dave Burt</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>23 Nov 2005</NOBR> at <NOBR>15:09</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><PRE><CODE>
f = fun {|a, b, *c| [a, b, *c] }
f[1,2] #=&gt; #&amp;lt;Fun:0x02b4ec58&gt; :(
</CODE></PRE>
For consistency, and the ability to call *args functions with empty args:
<PRE><CODE>
#...
  def call(*args)
 if args.size &lt; arity.abs and args.size != -arity - 1
#...
</CODE></PRE>

	<P>I predict that the thread below will contain an improved recipe for method currying, so stay tuned!</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>kig</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>23 Nov 2005</NOBR> at <NOBR>15:34</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Oho, good point with -arity. Another thing would be handling block arguments, any idea with that? E.g. </P>


	<PRE><CODE>f = fun{|x, &amp;b| x.map(&amp;b) }
double = f.call{|i| i*2 }
double[[1,2,3]]
#=&gt; [2,4,6]</CODE></PRE></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Dave Burt</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>23 Nov 2005</NOBR> at <NOBR>16:15</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Exactly what you posted will work in Ruby 1.9, but procs can’t take blocks in 1.8.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Danno</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>23 Nov 2005</NOBR> at <NOBR>16:40</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Pardon, but where is arity defined?</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Dave Burt</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>23 Nov 2005</NOBR> at <NOBR>16:53</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>arity is a method of Proc and Method and UnboundMethod.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Ian</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>23 Nov 2005</NOBR> at <NOBR>19:46</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Here’s <A href="http://www.rubycentral.com/book/ref_c_proc.html#Proc.arity">arity in Programming Ruby’s online reference</A> if you want to be specific about it.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>kig</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>23 Nov 2005</NOBR> at <NOBR>21:26</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent">Continuing with funny <DEL>thought</DEL> <I>code</I> experiments,
how about mixing Enumerables and Procs?
<PRE><CODE>
class Proc
include Enumerable
  attr_accessor :domain
  def each
    domain.each{|*e| yield call(*e) }
  end
  alias_method :range, :entries
end

f = lambda{|x| x * 2 }
f.domain = (1..5)
f.range
#=&gt; [2, 4, 6, 8, 10]

g = lambda{|y| y - 1 }
g.domain = f
g.range
#=&gt; [1, 3, 5, 7, 9]
</CODE></PRE></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>kig</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>23 Nov 2005</NOBR> at <NOBR>22:24</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent">Of course we could just do
<PRE><CODE>
class Proc
  def &gt;&gt; g
    lambda{|*args| g[self[*args]]}
  end
  def over enum
    enum.map &amp;self
  end
end

f = lambda{|x| x * 2 }
g = lambda{|y| y - 1 }
h = f &gt;&gt; g
h.over(1..5)
#=&gt; [1, 3, 5, 7, 9]
</CODE></PRE>
But it just doesn’t have the same feeling, somehow.</DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>trans</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>24 Nov 2005</NOBR> at <NOBR>00:38</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>On Suby we discussed a bit we picked up from Nemerle:</P>


	<PRE><CODE>def foo( x, y )
  x + y
end
bar = foo( _, 10 )
bar( 6 )  #=&gt; 16</CODE></PRE>


	<P>Apply it too lambdas just as well. Would be a cool feature.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>MenTaLguY</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>24 Nov 2005</NOBR> at <NOBR>12:12</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Okay, so we’ve got:</P>


	<UL>
	<LI>monads</LI>
	</UL>


	<UL>
	<LI>lazy evaluation</LI>
	</UL>


	<UL>
	<LI>automatic currying</LI>
	</UL>


	<UL>
	<LI>function composition (via kig’s &gt;&gt; operator)</LI>
	</UL>


	<P>Any other “scary” functional programming things left to do in Ruby?  Because I feel like we are running out.</P>


	<P>I mean, I suppose we could always do the old “Ruby Objects are really just functions” routine.</P>


<PRE><CODE>
class Object
  alias call send
  alias [] call
  def arity ; -1 ; end
  def to_proc ; method( :send ).to_proc ; end
end
</CODE></PRE>

	<P>Y’know, because they are.  They’re closures over their instance variables.  Their first parameter is a method name.</P>


<PRE><CODE>p [ :inspect, :class, [ :'+', 2 ] ].map( &amp;1 )</CODE></PRE>

<PRE><CODE> =&gt; ["1", Fixnum, 3]</CODE></PRE></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>MenTaLguY</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>24 Nov 2005</NOBR> at <NOBR>12:19</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>(Once we’re done here I think I’m going to make a raskell.rb with all this stuff in.  Just for kicks.)</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>MenTaLguY</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>24 Nov 2005</NOBR> at <NOBR>12:54</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Incidentally, once you see that objects are functions, it’s apparent that <CODE>Object#method</CODE> simply curries in the first argument.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>kig</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>24 Nov 2005</NOBR> at <NOBR>17:20</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><BLOCKQUOTE>
		<P>Any other “scary” functional programming things left to do in Ruby? Because I feel like we are running out.</P>
	</BLOCKQUOTE>


	<P>Hindley-Milner type inference? I kid, I kid.</P>


	<P>The Objects as functions -trick made me giggle with glee, good job.</P>


	<P>I found the following amusing:</P>


<PRE><CODE>
f = fun{|x| x * 2 }
f.domain = (1..5)

g = fun{|x| x - 2 }
g.domain = (3..7)

h = fun{|x,y| x * y }
h.domain = f

h.zip(g).map{|f,x| f[x] }
#=&gt; [2, 8, 18, 32, 50]
</CODE></PRE></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>jo</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>26 Nov 2005</NOBR> at <NOBR>06:14</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Haskell-style datatype.rb still seems to have room for improvement(cvs.m17n.org/viewcvs/ruby/).</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>nuro</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>26 Nov 2005</NOBR> at <NOBR>09:55</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Here is a functional-style one-liner to create n-dim arrays:</P>


	<P>md = lambda {|*ds| Array::new(ds.shift || 0).map {md[ds] unless ds.empty? }}; nar = md.call(8, 3, 5); puts nar.inspect</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>nuro</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>26 Nov 2005</NOBR> at <NOBR>10:00</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>correction: ... md[*ds] ...</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>t</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>29 Nov 2005</NOBR> at <NOBR>05:56</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><BLOCKQUOTE>
		<P>(Once we’re done here I think I’m going to make a raskell.rb with all this stuff in. Just for kicks.)</P>
	</BLOCKQUOTE>


	<P>Yes!! Please.</P></DIV></DIV>
</DIV>


  <DIV class="entry">
    <P><SMALL>Comments are closed for this entry.</SMALL></P>
  



        </DIV> 

</DIV>



</DIV>





</DIV></BODY></HTML>