<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0116)redhanded.hobix.com/inspect/hpricotTheOhfourthAndAllTheEncirclingKits.html -->
<HTML xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><HEAD><META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--<BASE href="http://redhanded.hobix.com.wstub.archive.org/inspect/hpricotTheOhfourthAndAllTheEncirclingKits.html">--><BASE href=".">


<TITLE>RedHanded » Hpricot the OhFourth</TITLE>
<LINK rel="shortcut icon" href="../favicon.ico" type="image/vnd.microsoft.icon" />
<LINK rel="icon" href="../favicon.ico" type="image/vnd.microsoft.icon" />
<META http-equiv="Pragma" content="no-cache">
<META http-equiv="Expires" content="-1">




<STYLE type="text/css">
 @import "../site.css"; 
</STYLE>
</HEAD><BODY>

<DIV id="page">

<DIV id="hoodwinkd">
  <A href="http://hoodwinkd.hobix.com/"><SPAN>hoodwink.d enhanced</SPAN></A>

</DIV>
<DIV id="buttons">
<DL class="tab">
  <DT><A title="Syndicate this Site" href="index.xml">RSS</A></DT>
  <DD><A title="Syndicate this Site" href="index.xml">2.0</A></DD>
</DL>
<DL class="tab xhtml">
  <DT><A title="Validate this Site" href="http://validator.w3.org/check?uri=http://redhanded.hobix.com/">XHTML</A></DT>
  <DD><A title="Validate this Site" href="http://validator.w3.org/check?uri=http://redhanded.hobix.com/">1.0</A></DD>
</DL>
</DIV>
<H1 class="title"><A href="../"><IMG src="../images/redhanded.gif" alt="RedHanded"></A></H1>
<DIV id="banner">
  <DIV class="tagline">sneaking Ruby through the system</DIV>
  <DIV class="nav"><A href="../5.gets/">5.gets</A> | <A href="../bits/">bits</A> | 
    <A href="../inspect/">inspect</A> | <A href="../cult/">the cult</A> | <A href="../-h/">-h</A></DIV>
</DIV>


<DIV id="content">
<DIV id="sidebar">
<P>New to RedHanded? <A href="../-h/pardonAndWelcome.html">About our sections.</A></P>

<DIV class="sidebarBox">
<H2 class="sidebarTitle">Archive</H2>
<UL>

    <LI><A href="../2004/12/">December 2004</A></LI>

    <LI><A href="../2005/01/">January 2005</A></LI>

    <LI><A href="../2005/02/">February 2005</A></LI>

    <LI><A href="../2005/03/">March 2005</A></LI>

    <LI><A href="../2005/04/">April 2005</A></LI>

    <LI><A href="../2005/05/">May 2005</A></LI>

    <LI><A href="../2005/06/">June 2005</A></LI>

    <LI><A href="../2005/07/">July 2005</A></LI>

    <LI><A href="../2005/08/">August 2005</A></LI>

    <LI><A href="../2005/09/">September 2005</A></LI>

    <LI><A href="../2005/10/">October 2005</A></LI>

    <LI><A href="../2005/11/">November 2005</A></LI>

    <LI><A href="../2005/12/">December 2005</A></LI>

    <LI><A href="../2006/01/">January 2006</A></LI>

    <LI><A href="../2006/02/">February 2006</A></LI>

    <LI><A href="../2006/03/">March 2006</A></LI>

    <LI><A href="../2006/04/">April 2006</A></LI>

    <LI><A href="../2006/05/">May 2006</A></LI>

    <LI><A href="../2006/06/">June 2006</A></LI>

    <LI><A href="../2006/07/">July 2006</A></LI>

    <LI><A href="../2006/08/">August 2006</A></LI>

    <LI><A href="../2006/09/">September 2006</A></LI>

    <LI><A href="../2006/10/">October 2006</A></LI>

    <LI><A href="../2006/11/">November 2006</A></LI>

    <LI><A href="../2006/12/">December 2006</A></LI>

    <LI><A href="../2007/01/">January 2007</A></LI>

    <LI><A href="../2007/02/">February 2007</A></LI>

    <LI><A href="../2007/03/">March 2007</A></LI>

    <LI><A href="../2007/04/">April 2007</A></LI>

    <LI><A href="../2007/05/">May 2007</A></LI>

</UL>
</DIV>

<P><A href="http://www.pragmaticprogrammer.com/titles/ruby/index.html"><IMG src="../images/prag-ruby-book.jpg" alt="PickAxe II"></A><BR>
<A href="http://www.pragmaticprogrammer.com/titles/ruby/index.html">Get your copy of <I>Programming Ruby</I>!</A></P>

 <DIV class="sidebarBox">
        <H2 class="sidebarTitle">Links</H2>
        <A href="http://technorati.com/tags/ruby">@technorati</A><BR>
<A href="http://del.icio.us/tag/ruby">@del.icio.us</A><BR>
<A href="http://www.flickr.com/photos/tags/ruby">@flickr</A><BR>
<A href="http://www.artima.com/articles/index.jsp?topic=ruby">@artima</A><BR>
<A href="http://blog.caboo.se/">@caboo</A><BR>
<A href="http://www.oreillynet.com/ruby">@oreilly</A><BR>
<A href="http://ruby-lang.org/">ruby</A><BR>
<A href="http://ruby-doc.org/">-&gt; docs</A><BR>
<A href="http://rubyforge.org/">-&gt; wares</A><BR>
<A href="http://rubygarden.org/ruby/">-&gt; wiki</A><BR>
<A href="http://www.sitepoint.com/forums/forumdisplay.php?f=227">-&gt; forum</A><BR>
<A href="http://www.rubyquiz.com/">-&gt; quizzes</A><BR>
<A href="http://planetruby.0x42.net/">-&gt; planet</A><BR>
<A href="http://meme.b9.com/cdates.html?channel=ruby-lang">-&gt; irc</A><BR>
<A href="http://www.rubyweeklynews.org/">rubyweeklynews</A><BR>
<A href="http://weblog.rubyonrails.com/">rails</A><BR>
<A href="http://wiki.rubyonrails.org/">-&gt; wiki</A><BR>
<A href="http://www.planetrubyonrails.org/">-&gt; planet</A><BR>
<A href="http://thesaq.com/rubyonrails/">-&gt; irc</A><BR>
<A href="http://anarchaia.org/">%anarchaia</A><BR>
<A href="http://project.ioni.st/">%projectionist</A><BR>
<A href="http://pugs.blogs.com/">~audreyt</A><BR>
<A href="http://dablog.rubypal.com/">~black</A><BR>
<A href="http://www.jamesbritt.com/">~britt</A><BR>
<A href="http://www.jamisbuck.org/jamis/">~buck</A><BR>
<A href="http://tomcopeland.blogs.com/juniordeveloper/">~copeland</A><BR>
<A href="http://eigenclass.org/">~fernandez</A><BR>
<A href="http://www.chadfowler.com/">~fowler</A><BR>
<A href="http://www.loudthinking.com/">~hansson</A><BR>
<A href="http://blog.segment7.net/">~hodel</A><BR>
<A href="http://slash7.com/">~hoy/7</A><BR>
<A href="http://fhwang.net/">~hwang</A><BR>
<A href="http://blog.leetsoft.com/">~luetke</A><BR>
<A href="http://www.worldlingo.com/wl/translate?wl_lp=JA-en&wl_glossary=gl1&wl_fl=3&wl_rurl=http%3A%2F%2Fwww.rubyist.net%2F%7Ematz%2F&wl_url=http%3A%2F%2Fwww.rubyist.net%2F%7Ematz%2F&wl_g_table=-3">~matz</A><BR>
<A href="http://moonbase.rydia.net/">~mental</A><BR>
<A href="http://techno-weenie.net/">~olson</A><BR>
<A href="http://pragprog.com/pragdave">~pragdave</A><BR>
<A href="http://www.livejournal.com/users/premshree/">~premshree</A><BR>
<A href="http://kronavita.de/chris/blog/">~neukirchen</A><BR>
<A href="http://www.robbyonrails.com/">~robby</A><BR>
<A href="http://www.rousette.org.uk/">~rousette</A><BR>
<A href="http://nubyonrails.com/">~topfunky</A><BR>
<A href="http://www.jvoorhis.com/">~voorhis</A><BR>
<A href="http://onestepback.org/">~weirich</A><BR>
<A href="http://blog.zenspider.com/">~zenspider</A><BR>
        </DIV> 
 <DIV class="sidebarBox">
        <H2 class="sidebarTitle">Syndicate</H2>
        <UL>
            <LI><A href="../index.xml">RSS 2.0</A></LI>
        </UL>
        </DIV> 
 <DIV class="sidebarBox">
        <P>Built upon <A href="http://hobix.com/">Hobix</A></P>
        </DIV> 
<IMG src="../images/redhanded-duck.gif" alt="Type the Duck">
<DIV class="email">Got a story for us? <A href="../mailto:redhanded@hobix.com">E-mail it!</A></DIV>
<DIV class="technorati"><P><A href="http://www.technorati.com/profile/whytheluckystiff">Technorati Profile</A>
<A href="http://www.technorati.com/cosmos/search.html?url=http%3A%2F%2Fredhanded.hobix.com"><BR>
<IMG src="../images/bubble_icon.gif" height="20" width="24" alt="Get Conversations about RedHanded &raquo; sneaking Ruby through the system"></A>
</P>
</DIV>

</DIV>


 <DIV id="blog">
        
<DIV class="entry">
    <H2 class="entryTitle">Hpricot the OhFourth
  <SPAN class="entryPermalink"><A href="../inspect/hpricotTheOhfourthAndAllTheEncirclingKits.html" title="Permanent link to &ldquo;Hpricot the OhFourth&rdquo;">#</A></SPAN>
</H2>

<DIV class="entrySection">by <A href="http://whytheluckystiff.net/" title="Visit why&#39;s homepage">why</A> 
  in <A href="../inspect" title="List of entries in the &ldquo;inspect&rdquo; category">inspect</A>
</DIV>

     <DIV class="entryContent"><P>Well, here’s a new release of Hpricot: 0.4.  This I didn’t expect.  Thank the persistent fellows who kept hitting my inbox.  They’re cited in the <A href="../https://code.whytheluckystiff.net/svn/hpricot/tags/0.4/CHANGELOG"><SPAN class="caps">CHANGELOG</SPAN></A> for sending me all manner of palsied <SPAN class="caps">HTML</SPAN> with quoting all askew and tilted.</P>


	<P style="float:left"><IMG src="../images/hpricot-small.png" alt=""></P>


	<P>In fact, did you know that you can give Hpricot a plain text file, say one that has just a few <SPAN class="caps">HTML</SPAN> snips in it, and you can alter those snips and then output the page again and it just works like that?  This child’s only five weeks old still, so there are still encoding and entity and namespace matters to see to.</P>


	<P>To install: <CODE>gem install hpricot</CODE>. Win32 and source gems.</P>


	<H2>What Does One Do With Hpricot?</H2>


	<UL>
	<LI>To learn about using Hpricot, try <A href="http://code.whytheluckystiff.net/hpricot/wiki/AnHpricotShowcase">AnHpricotShowcase</A>, which gives a bunch of common examples.</LI>
		<LI>Christoffer Sawicki’s <A href="http://termos.vemod.net/feedalizer">Feedalizer</A> uses Hpricot to turn plain <SPAN class="caps">HTML</SPAN> pages into feeds.  <A href="http://vemod.net/code/feedalizer/trunk/examples/sydsvenskan-nemi.rb">See?</A></LI>
		<LI><SPAN class="caps">WWW</SPAN>::Mechanize trunk now <A href="http://tenderlovemaking.com/2006/08/08/more-ruby-mechanize-dev/">uses Hpricot</A>  for its automated browsing.</LI>
		<LI>And Zed’s RFuzz site has some <A href="http://rfuzz.rubyforge.org/sample.html">Hpricot sample code</A>, if you’re ready to ditch Net::HTTP for some superior socketry.  (See also: <A href="http://rubyforge.org/plugins/scmsvn/viewcvs.php/lib/rfuzz/browser.rb?root=rfuzz&view=log">RFuzz::Browser</A>!)</LI>
	</UL></DIV> 
</DIV>
<DIV class="entryFooter"> 
    <NOBR>11 Aug 2006</NOBR> at <NOBR>14:39</NOBR>
    <NOSCRIPT></NOSCRIPT>
   | 
    21 comments
</DIV>
</DIV>
<DIV id="comments">


<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Ezra</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>11 Aug 2006</NOBR> at <NOBR>15:13</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Very cool _why. I’m using hpricot to scrape dirty dirty insurance company websites for data extraction. It handles them fats and better then other solutions I’ve tried.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>der-matthias</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>11 Aug 2006</NOBR> at <NOBR>16:01</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Digging with Hpricot is just plain fun.</P>


	<P>Thank you, _why.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>FlashHater</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>11 Aug 2006</NOBR> at <NOBR>18:15</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>I knew something was up with Hpricot. I had just set my walpaper to the Hpricot logo!</P>


	<P>I use Hpricot to scrape the Second Life status page durring downtimes, and use mpd.rb to activate my music when it comes up/goes down.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>kballard</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>11 Aug 2006</NOBR> at <NOBR>20:03</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Hrm, I really should start using Hpricot.</P>


	<P>I was going over the HpricotBasics page and I noticed something that seems incorrect. It says you can re-search an Hpricot::Elements, which works, but the example given returns another Hpricot::Elements as the result of the sub-search. When I try it, I get a simple array back.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>why</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>11 Aug 2006</NOBR> at <NOBR>20:37</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Okay, <A href="../https://code.whytheluckystiff.net/hpricot/changeset/43">[43]</A>, thanks kballard.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Daniel Berger</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>11 Aug 2006</NOBR> at <NOBR>23:31</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Nice.</P>


I wonder if we’re overly enamored with the xpath syntax.  I normally hate method_missing, but perhaps it has its place here.  Instead of:
<PRE>doc/:html/:body/:p/:img
</PRE>
How about?
<PRE>doc.html.body.p.img
</PRE>
Too  CGI ?  Other problems?</DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>stepheneb</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>12 Aug 2006</NOBR> at <NOBR>08:44</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Sounds cool.</P>


	<P>I’m on MacOS  X 10 .7. I tried to install, told me it couldn’t find ragel  and rlcodegen. OK, I’ll start with ragel. I tried using DarwinPorts, that dies trying to ./configure bison … Ok so I just load the archive from here: http://www.cs.queensu.ca/home/thurston/ragel/ragel-5.11.tar.gz … it tells me I need bison, flex gperf … I’ve already got bison and flex installed … so I get an archive of gperf here: http://ftp.wayne.edu/pub/gnu/gperf/gperf-3.0.2.tar.gz … but I get this error: “checking whether the C compiler works… configure: error: cannot run C compiled programs. If you meant to cross compile, use `—host’.”</P>


	<P>Has anybody else had this problem?</P>


	<P>Thanks</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>why</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>12 Aug 2006</NOBR> at <NOBR>10:00</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P><STRONG>stephenb:</STRONG> How were you trying to install?  Using the gem or from trunk?</P>


	<P>For those who want to install from source:
<A href="http://code.whytheluckystiff.net/dist/hpricot-0.4.tgz">hpricot-0.4.tgz</A>.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>stepheneb</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>12 Aug 2006</NOBR> at <NOBR>13:02</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>From subversion:</P>


	<P>svn co https://code.whytheluckystiff.net/svn/hpricot/trunk hpricot
=&gt; 
  ...
  Checked out revision 43.
rake
=&gt; 
  sh: line 1: rlcodegen: command not found
  sh: line 1: ragel: command not found</P>


	<P>That’s when I starting looking for ragel.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>MonkeeSage</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>12 Aug 2006</NOBR> at <NOBR>15:41</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>There appear to be some ports of gperf for Darwin (<A href="http://www.google.com/search?q=darwin+gperf">google</A>). Also, using the <A href="http://www.freebsd.org/cgi/ports.cgi?query=ragel&stype=name">FreeBSD port</A> of ragel might work (mabye, possibly, probably not), since Darwin is built on Mach3/FreeBSD.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>pygmalion</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>13 Aug 2006</NOBR> at <NOBR>01:56</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>I’ve completely ported my  REXML  code to Hpricot and couldn’t be happier with the speed improvements :)</P>


	<P>But now I’m facing a very embarrassing issue (as in, I should have though of it before starting): Hpricot doesn’t substitute html entities :/</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Boris K.</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>15 Aug 2006</NOBR> at <NOBR>10:33</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>why,</P>


	<P>In elements.rb</P>


<PRE>204         filter ":last-child" do |i|
205           self == parent.containers.first
206         end
</PRE>

	<P>Line 205 should be </P><PRE>self == parent.containers.last</PRE><P></P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>James</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>18 Aug 2006</NOBR> at <NOBR>01:44</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Wow. Just wow. It’s <STRONG>awesome</STRONG> to be able to parse a fragment or snippet into an object model.</P>


	<P>I want my validator to be strict, but I want my parser to be loose. This works exactly how I’ve wanted something processing markup to work.</P>


	<P>For those of us living in the real world where we can’t necessarily demand that other parties fix up their output or provide nice little parseable feeds.</P>


	<P>Thanks for this gem, the mashup possibilities will be interesting :D</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>chickenkiller</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>18 Aug 2006</NOBR> at <NOBR>07:55</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P><STRONG>why:</STRONG> Shouldn’t the wrap() method be called wrap!() instead? I searched for the result for a while until I discovered it directly modifies the document…</P>


	<P>Tell me if I am wrong.</P>


	<P>cheers</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>skwasha</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>18 Aug 2006</NOBR> at <NOBR>12:00</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent">newb question… what if I want to grab all the tags between two other tags? But they are not hierarchical. E.g. 
<PRE>  &lt; h1&gt;stuff&lt; /h1&gt;
  &lt; h1&gt;diff stuff&lt; /h1&gt;
  &lt; p&gt;something&lt; /p&gt;
  &lt; div id="a"&gt;hmmm&lt; /div&gt;
</PRE>
and I want everything between the first h1 and the div with id ‘a’?</DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>MonkeeSage</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>18 Aug 2006</NOBR> at <NOBR>14:48</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P><B>skwasha</B>: I just started playing with Hpricot , so there’s probably a better way to do it, but something like this would work:</P>


<PRE><CODE>
require('hpricot')
HTML = %{
  &lt;h1&gt;stuff&lt;/h1&gt;
  &lt;h1&gt;diff stuff&lt;/h1&gt;
  &lt;p&gt;something&lt;/p&gt;
  &lt;div id="a"&gt;hmmm&lt;/div&gt;
}
doc   = Hpricot(HTML)
found = []
front = true
doc.traverse_all_element { |node|
  if (node.name == 'h1' and front)
    front = false
    next
  elsif (node.name == 'div' and
         node.attributes['id'] == 'a')
    next
  else
    found &lt;&lt; node
  end
}
# do something useful here...
found.collect! { |item| item.to_html + "\n" }
puts(found)
# &gt;&gt; &lt;h1&gt;diff stuff&lt;/h1&gt;
# &gt;&gt; &lt;p&gt;something&lt;/p&gt;</CODE></PRE></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>chao</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>19 Aug 2006</NOBR> at <NOBR>16:10</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>_why, thanks for sharing Hpricot.</P>


	<P>One request: can you handle non  XHTML  compliant tags like <CODE>&lt;image&gt;, &lt;hr&gt; and &lt;br&gt;</CODE>?</P>


	<P>Currently:</P>


<PRE><CODE>
d = Hpricot("&lt;image src='xyz'&gt;abc&lt;p&gt;a simple line&lt;/p&gt;" 
d.innerHTML

returns

d.innerHTML
=&gt; "&lt;image src=\"xyz\"&gt;abc&lt;p&gt;a simple line&lt;/p&gt;&lt;/image&gt;" 

</CODE></PRE><CODE></CODE>

	<P>Thanks!</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>chao</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>19 Aug 2006</NOBR> at <NOBR>16:27</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>oops, my bad. I guess I just don’t know my  HTML  from <CODE></CODE></P><CODE><PRE>&lt;image&gt; and &lt;img&gt;</PRE></CODE>!<P></P>


	<P>It’s really cool you do support these weird tags!</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>squarelover</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>20 Aug 2006</NOBR> at <NOBR>16:23</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Where was Hpricot 5 months ago when I needed to parse 10,000 inconsistent  HTML  pages for content and stuff them into a database. I had Regex coming out my nose. This would have been simpler and cleaner.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>UnderpantsGnome</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>23 Aug 2006</NOBR> at <NOBR>21:26</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent">why, you rock or “How I made an  HTML  scrubber in under 25 lines”.
<PRE><CODE>
module Hpricot
  class Elements
    def strip
      each { |x| x.strip }
    end

    def strip_attributes(safe=[])
      each { |x| x.strip_attributes(safe) }
    end
  end

  class Elem
    def strip
      parent.replace_child self, Hpricot.make(inner_html)
    end

    def strip_attributes(safe=[])
      attributes.each {|atr|
          remove_attribute(atr[0]) unless
            safe.include?(atr[0])
      } unless attributes.nil?
    end
  end
end

# remove all anchors leaving behind the text inside.
(doc/:a).strip 
# strip all attributes except for src from all images
(doc/:img).strip_attributes(['src']) 
</CODE></PRE></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>clambert</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>27 Aug 2006</NOBR> at <NOBR>23:21</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Thanks for Hpricot, why_. I’ve been using it for a number of things and it’s been a lifesaver. However, I came across a parser bug which occurs when you have a large  HTML  table with unclosed td tags—I get a stack overflow.</P>


	<P>Doesn’t look like the Trac accepts tickets, so I’m filing it here. ;-)</P>


	<P>Hpricot(open(‘http://survey.netcraft.com/Reports/0512/’).read)</P></DIV></DIV>
</DIV>


<DIV class="entry">
<FORM name="userComment" method="post" action="/api/comment/inspect/hpricotTheOhfourthAndAllTheEncirclingKits">
  <DIV class="entryAttrib">
     <DIV class="entryAuthor"><INPUT name="sayor" type="textbox" size="15" maxlength="50"></DIV>
     <DIV id="liveTime" class="entryTime"><NOBR>11 Jul 2010</NOBR> at <NOBR>21:19</NOBR></DIV>
  </DIV>
  <DIV class="entryContentOuter"><DIV class="entryContent">
     <INPUT type="hidden" name="timestamp" value="yopYLare1A">
     <TEXTAREA name="consay" rows="6" cols="50"></TEXTAREA>
     <P><INPUT type="button" name="pleasePreview" value="preview" onclick="liveTextilePreview(document.forms[&#39;userComment&#39;].elements[&#39;consay&#39;], &#39;textilePreview&#39;, &#39;/api/preview&#39;)">
        <INPUT type="submit" name="submit" value="&gt;&gt;">
        <SMALL>* do <A href="../javascript:quickRedReference();">fancy stuff</A> in your comment.</SMALL>
     </P>
     <DIV id="textileWrap"><H4>PREVIEW PANE</H4>
     <DIV id="textilePreview"></DIV>
     </DIV>
     </DIV>
  </DIV></FORM></DIV>
  



        </DIV> 

</DIV>



</DIV>





</BODY></HTML>