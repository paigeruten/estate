<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0093)redhanded.hobix.com/inspect/showingPerfectTime.html -->
<HTML xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><HEAD><META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--<BASE href="http://redhanded.hobix.com.wstub.archive.org/inspect/showingPerfectTime.html">--><BASE href=".">


<TITLE>RedHanded » Showing Perfect Time</TITLE>
<LINK rel="shortcut icon" href="../favicon.ico" type="image/vnd.microsoft.icon" />
<LINK rel="icon" href="../favicon.ico" type="image/vnd.microsoft.icon" />
<META http-equiv="Pragma" content="no-cache">
<META http-equiv="Expires" content="-1">




<STYLE type="text/css">
 @import "../site.css"; 
</STYLE>
</HEAD><BODY>

<DIV id="page">

<DIV id="hoodwinkd">
  <A href="http://hoodwinkd.hobix.com/"><SPAN>hoodwink.d enhanced</SPAN></A>

</DIV>
<DIV id="buttons">
<DL class="tab">
  <DT><A title="Syndicate this Site" href="index.xml">RSS</A></DT>
  <DD><A title="Syndicate this Site" href="index.xml">2.0</A></DD>
</DL>
<DL class="tab xhtml">
  <DT><A title="Validate this Site" href="http://validator.w3.org/check?uri=http://redhanded.hobix.com/">XHTML</A></DT>
  <DD><A title="Validate this Site" href="http://validator.w3.org/check?uri=http://redhanded.hobix.com/">1.0</A></DD>
</DL>
</DIV>
<H1 class="title"><A href="../"><IMG src="../images/redhanded.gif" alt="RedHanded"></A></H1>
<DIV id="banner">
  <DIV class="tagline">sneaking Ruby through the system</DIV>
  <DIV class="nav"><A href="../5.gets/">5.gets</A> | <A href="../bits/">bits</A> | 
    <A href="../inspect/">inspect</A> | <A href="../cult/">the cult</A> | <A href="../-h/">-h</A></DIV>
</DIV>


<DIV id="content">
<DIV id="sidebar">
<P>New to RedHanded? <A href="../-h/pardonAndWelcome.html">About our sections.</A></P>

<DIV class="sidebarBox">
<H2 class="sidebarTitle">Archive</H2>
<UL>

    <LI><A href="../2004/12/">December 2004</A></LI>

    <LI><A href="../2005/01/">January 2005</A></LI>

    <LI><A href="../2005/02/">February 2005</A></LI>

    <LI><A href="../2005/03/">March 2005</A></LI>

    <LI><A href="../2005/04/">April 2005</A></LI>

    <LI><A href="../2005/05/">May 2005</A></LI>

    <LI><A href="../2005/06/">June 2005</A></LI>

    <LI><A href="../2005/07/">July 2005</A></LI>

    <LI><A href="../2005/08/">August 2005</A></LI>

    <LI><A href="../2005/09/">September 2005</A></LI>

    <LI><A href="../2005/10/">October 2005</A></LI>

    <LI><A href="../2005/11/">November 2005</A></LI>

    <LI><A href="../2005/12/">December 2005</A></LI>

    <LI><A href="../2006/01/">January 2006</A></LI>

    <LI><A href="../2006/02/">February 2006</A></LI>

    <LI><A href="../2006/03/">March 2006</A></LI>

    <LI><A href="../2006/04/">April 2006</A></LI>

    <LI><A href="../2006/05/">May 2006</A></LI>

    <LI><A href="../2006/06/">June 2006</A></LI>

    <LI><A href="../2006/07/">July 2006</A></LI>

    <LI><A href="../2006/08/">August 2006</A></LI>

    <LI><A href="../2006/09/">September 2006</A></LI>

    <LI><A href="../2006/10/">October 2006</A></LI>

    <LI><A href="../2006/11/">November 2006</A></LI>

    <LI><A href="../2006/12/">December 2006</A></LI>

    <LI><A href="../2007/01/">January 2007</A></LI>

    <LI><A href="../2007/02/">February 2007</A></LI>

    <LI><A href="../2007/03/">March 2007</A></LI>

    <LI><A href="../2007/04/">April 2007</A></LI>

    <LI><A href="../2007/05/">May 2007</A></LI>

</UL>
</DIV>

<P><A href="http://www.pragmaticprogrammer.com/titles/ruby/index.html"><IMG src="../images/prag-ruby-book.jpg" alt="PickAxe II"></A><BR>
<A href="http://www.pragmaticprogrammer.com/titles/ruby/index.html">Get your copy of <I>Programming Ruby</I>!</A></P>

 <DIV class="sidebarBox">
        <H2 class="sidebarTitle">Links</H2>
        <A href="http://technorati.com/tags/ruby">@technorati</A><BR>
<A href="http://del.icio.us/tag/ruby">@del.icio.us</A><BR>
<A href="http://www.flickr.com/photos/tags/ruby">@flickr</A><BR>
<A href="http://www.artima.com/articles/index.jsp?topic=ruby">@artima</A><BR>
<A href="http://blog.caboo.se/">@caboo</A><BR>
<A href="http://www.oreillynet.com/ruby">@oreilly</A><BR>
<A href="http://ruby-lang.org/">ruby</A><BR>
<A href="http://ruby-doc.org/">-&gt; docs</A><BR>
<A href="http://rubyforge.org/">-&gt; wares</A><BR>
<A href="http://rubygarden.org/ruby/">-&gt; wiki</A><BR>
<A href="http://www.sitepoint.com/forums/forumdisplay.php?f=227">-&gt; forum</A><BR>
<A href="http://www.rubyquiz.com/">-&gt; quizzes</A><BR>
<A href="http://planetruby.0x42.net/">-&gt; planet</A><BR>
<A href="http://meme.b9.com/cdates.html?channel=ruby-lang">-&gt; irc</A><BR>
<A href="http://www.rubyweeklynews.org/">rubyweeklynews</A><BR>
<A href="http://weblog.rubyonrails.com/">rails</A><BR>
<A href="http://wiki.rubyonrails.org/">-&gt; wiki</A><BR>
<A href="http://www.planetrubyonrails.org/">-&gt; planet</A><BR>
<A href="http://thesaq.com/rubyonrails/">-&gt; irc</A><BR>
<A href="http://anarchaia.org/">%anarchaia</A><BR>
<A href="http://project.ioni.st/">%projectionist</A><BR>
<A href="http://pugs.blogs.com/">~audreyt</A><BR>
<A href="http://dablog.rubypal.com/">~black</A><BR>
<A href="http://www.jamesbritt.com/">~britt</A><BR>
<A href="http://www.jamisbuck.org/jamis/">~buck</A><BR>
<A href="http://tomcopeland.blogs.com/juniordeveloper/">~copeland</A><BR>
<A href="http://eigenclass.org/">~fernandez</A><BR>
<A href="http://www.chadfowler.com/">~fowler</A><BR>
<A href="http://www.loudthinking.com/">~hansson</A><BR>
<A href="http://blog.segment7.net/">~hodel</A><BR>
<A href="http://slash7.com/">~hoy/7</A><BR>
<A href="http://fhwang.net/">~hwang</A><BR>
<A href="http://blog.leetsoft.com/">~luetke</A><BR>
<A href="http://www.worldlingo.com/wl/translate?wl_lp=JA-en&wl_glossary=gl1&wl_fl=3&wl_rurl=http%3A%2F%2Fwww.rubyist.net%2F%7Ematz%2F&wl_url=http%3A%2F%2Fwww.rubyist.net%2F%7Ematz%2F&wl_g_table=-3">~matz</A><BR>
<A href="http://moonbase.rydia.net/">~mental</A><BR>
<A href="http://techno-weenie.net/">~olson</A><BR>
<A href="http://pragprog.com/pragdave">~pragdave</A><BR>
<A href="http://www.livejournal.com/users/premshree/">~premshree</A><BR>
<A href="http://kronavita.de/chris/blog/">~neukirchen</A><BR>
<A href="http://www.robbyonrails.com/">~robby</A><BR>
<A href="http://www.rousette.org.uk/">~rousette</A><BR>
<A href="http://nubyonrails.com/">~topfunky</A><BR>
<A href="http://www.jvoorhis.com/">~voorhis</A><BR>
<A href="http://onestepback.org/">~weirich</A><BR>
<A href="http://blog.zenspider.com/">~zenspider</A><BR>
        </DIV> 
 <DIV class="sidebarBox">
        <H2 class="sidebarTitle">Syndicate</H2>
        <UL>
            <LI><A href="../index.xml">RSS 2.0</A></LI>
        </UL>
        </DIV> 
 <DIV class="sidebarBox">
        <P>Built upon <A href="http://hobix.com/">Hobix</A></P>
        </DIV> 
<IMG src="../images/redhanded-duck.gif" alt="Type the Duck">
<DIV class="email">Got a story for us? <A href="../mailto:redhanded@hobix.com">E-mail it!</A></DIV>
<DIV class="technorati"><P><A href="http://www.technorati.com/profile/whytheluckystiff">Technorati Profile</A>
<A href="http://www.technorati.com/cosmos/search.html?url=http%3A%2F%2Fredhanded.hobix.com"><BR>
<IMG src="../images/bubble_icon.gif" height="20" width="24" alt="Get Conversations about RedHanded &raquo; sneaking Ruby through the system"></A>
</P>
</DIV>

</DIV>


 <DIV id="blog">
        
<DIV class="entry">
    <H2 class="entryTitle">Showing Perfect Time
  <SPAN class="entryPermalink"><A href="../inspect/showingPerfectTime.html" title="Permanent link to &ldquo;Showing Perfect Time&rdquo;">#</A></SPAN>
</H2>

<DIV class="entrySection">by <A href="http://whytheluckystiff.net/" title="Visit why&#39;s homepage">why</A> 
  in <A href="../inspect" title="List of entries in the &ldquo;inspect&rdquo; category">inspect</A>
</DIV>

     <DIV class="entryContent"><P>What timezone do your site’s timestamps show?  Or have you opted to just say <EM>three months ago</EM>?  Or you could offer the user a <A href="http://wiki.rubyonrails.com/rails/pages/HowtoSetDefaultTimeZone">timezone</A> setting, right? These are tough issues, with a worldwide audience which could be anywhere and a server which could end up moving anywhere as well.</P>


	<P>Hold up.  Before you start writing anything, ecmanaut has <A href="http://ecmanaut.blogspot.com/2006/01/ajax-date-time-time-zones-best.html">a very convincing rant</A>  on not interfering at all.  Just pass <SPAN class="caps">UNIX</SPAN> time straight out of the database and format the time in Javascript.  (Read his article and trounce back here for the slight Ruby code.)</P>


	<H2>Pitching Timestamps to Javascript</H2>


	<P>Can’t you see your web framework abstracting this away nicely?</P>


<PRE>  Posted by &lt;%= user.name %&gt; on &lt;%=js_time post.created_at %&gt;
</PRE>

	<P>I’ve added this in Hoodwink’d like so:</P>


<PRE> def js_time( unixt, fmt = "%d %b %Y at %I:%M:%S %p" )
   %{
      &lt;script type="text/javascript"&gt;
        document.write((new Date(#{unixt.to_i * 1000})).strftime(#{fmt.dump}));
      &lt;/script&gt;
      &lt;noscript&gt;
        #{Time.at(unixt.to_i).strftime(fmt)}
      &lt;/noscript&gt;
   }
 end
</PRE>

	<P class="update"><STRONG>Notice of caution:</STRONG> The above method uses a pretty tacky script/noscript scenario.  Mike West has approached the situation better on <A href="http://mikewest.org/blog/id/20">his blog</A>.  You can use this code instead:</P>


<PRE> def js_time( unixt, fmt = "%d %b %Y at %I:%M:%S %p" )
   %{
      &lt;span class='PerfectTime' gmt_time='#{unixt.to_i}' format='#{fmt}'&gt;
        #{Time.at(unixt.to_i).strftime(fmt)}
      &lt;/span&gt;
   }
 end
</PRE>

	<P>This method takes a unix timestamp and writes out a script tag which will format the date according to the user’s locale.  If no Javascript is available, time according to the server’s timezone will be reported.</P>


	<H2>Unity of Time Formatting</H2>


	<P>This is also dependant upon a Javascript version of Ruby’s own <CODE>strftime</CODE>.</P>


<PRE> /* strftime formats */
 var strftime_funks = {
   zeropad: function( n ){ return n&gt;9 ? n : '0'+n; },
   a: function(t) { return ['Sun','Mon','Tue','Wed',
      'Thu','Fri','Sat'][t.getDay()] },
   A: function(t) { return ['Sunday','Monday','Tuedsay',
      'Wednesday','Thursday','Friday','Saturday'][t.getDay()] },
   b: function(t) { return ['Jan','Feb','Mar','Apr',
      'May','Jun', 'Jul','Aug','Sep','Oct','Nov','Dec'
      ][t.getMonth()] },
   B: function(t) { return ['January','February','March','April',
      'May','June', 'July','August','September','October',
      'November','December'][t.getMonth()] },
   c: function(t) { return t.toString() },
   d: function(t) { return this.zeropad(t.getDate()) },
   H: function(t) { return this.zeropad(t.getHours()) },
   I: function(t) { return this.zeropad((t.getHours() + 12) % 12) },
   m: function(t) { return this.zeropad(t.getMonth()+1) }, // month-1
   M: function(t) { return this.zeropad(t.getMinutes()) },
   p: function(t) { return this.H(t) &lt; 12 ? 'AM' : 'PM'; },
   S: function(t) { return this.zeropad(t.getSeconds()) },
   w: function(t) { return t.getDay() }, // 0..6 == sun..sat
   y: function(t) { return this.zeropad(this.Y(t) % 100); },
   Y: function(t) { return t.getFullYear() },
  '%': function(t) { return '%' }
 };

 Date.prototype.strftime = function (fmt) {
    var t = this;
    for (var s in strftime_funks) {
        if (s.length == 1 )
            fmt = fmt.replace('%' + s, strftime_funks[s](t));
    }
    return fmt;
 };
</PRE>

	<P>Download the <A href="http://whytheluckystiff.net/ruby/strftime.js">full strftime.js</A>.</P>


	<H2>The Best?</H2>


	<P>Is this the best option?  Is this even a good option?  Obviously, the biggest weakness is whether your users’ clocks are right or not.  And whether Javascript is on or not.  With Hoodwink’d, users have to use Javascript.  Even the MouseHole version requires it.</P>


	<P>I buy <A href="http://hoodwink.d/ecmanaut/">ecmanaut’s</A> argument completely, along with his recommendation for backing it all up with a timezone selector.</P>


	<BLOCKQUOTE>
		<P>As you are pioneering this field of end-user usability, you may want to state that times and dates are indeed given in the visitor’s frame of reference, as people have generally come to expect to see times given in some random and hence typically fairly useless time zone. This can be seen as a not entirely bad reason for actually providing a time zone configuration option, should you want one. I would suggest defaulting it to “auto” or “local time” using the above method, though, as that is most likely what the user would want to see, anyway. This way, the configuration option actually doubles as documentation of what times the site shows, in a place a visitor is likely to look for it. To make it extra apparent that you render proper times, you might equip the page with the setting with a printout of present time, which the visitor will easily recognize as the time her computer clock shows (since they are in fact one and the same).</P>
	</BLOCKQUOTE>


	<P class="update"><STRONG>Okay,</STRONG> things were broken in Safari, which is missing JavaScript replace callback support.  I’ve changed to a loop in the above code and also updated the strftime.js file.</P></DIV> 
</DIV>
<DIV class="entryFooter"> 
    <NOBR>14 Jan 2006</NOBR> at <NOBR>19:20</NOBR>
    <NOSCRIPT></NOSCRIPT>
   | 
    23 comments
</DIV>
</DIV>
<DIV id="comments">


<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>jlong</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>14 Jan 2006</NOBR> at <NOBR>19:58</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>I believe Typo uses this method.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>PJ</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>14 Jan 2006</NOBR> at <NOBR>21:36</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>That’s quite brilliant actually.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>MenTaLguY</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>14 Jan 2006</NOBR> at <NOBR>21:59</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Agh, thank goodness.  A sane fix for this timestamp thing.  Thanks for bringing this to our attention~</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>MenTaLguY</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>14 Jan 2006</NOBR> at <NOBR>22:07</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Incidentally, that strftime implementation is quite beautiful.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Pan</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>15 Jan 2006</NOBR> at <NOBR>07:04</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>That’s just beautiful.</P>

	<P>Speaking about dates, though,  there’s a bug in your comment field. At least for me, on Firefox 1.5, it says   said on 00 Jan 2006. U, at least, am not living in some weirdo land where months have a day number zero. Since you just served us this brilliant solution for dates, I believe you’d have no problem fixing this as well.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>crzwdjk</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>15 Jan 2006</NOBR> at <NOBR>07:47</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>It’s a wonderful idea, I’m amazed that nobody has thought of this earlier. It’s so much more useful most of the time than some arbitrary random timezone. And setting timezone settings on each website is a pain… what if you move from one timezone to another? You have to change all of them. And of course you forget one. And that’s the one that matters.
This is exactly the sort of thing that’s best done on the client side, and that’s what javascript is for after all.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>ecmanaut</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>15 Jan 2006</NOBR> at <NOBR>08:57</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>I’m not going to claim close familiarity with the Ruby strftime method, but I would believe that your regexp in the javascript strftime() implementation should lose the plus sign. And thanks for downstating the rantiness of my version to a level of mere pragmatism. :-)</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>why</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>15 Jan 2006</NOBR> at <NOBR>10:25</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P><STRONG>Pan</STRONG>: I’ve just moved RedHanded over to this just now.  Any better?</P>

	<P><STRONG>ecmanaut</STRONG>: Good and healed.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Danny</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>15 Jan 2006</NOBR> at <NOBR>15:32</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>See my comment at ecmanaut’s. Also, if you’re really going for javascript time localization, please remove the AM/PM that I’m still seeing… We have a 24-hour clock in my time zone…</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>jix</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>15 Jan 2006</NOBR> at <NOBR>15:42</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Safari starts to print function (str, .... :(</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>ecmanaut</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>15 Jan 2006</NOBR> at <NOBR>17:31</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>12 or 24 hour time isn’t time zone but locale bound; that is entirely another issue, and a data point which unfortunately doesn’t get exposed to browser javascript. It’s just the actual time reading we can present in visitor time, not the formatting of it.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>placey</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>15 Jan 2006</NOBR> at <NOBR>18:19</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>I want to echo what jix said, just in case _why doesn’t follow it.  When reading this site in Safari, the javascript for formatting dates is showing as text.
 That is, on all the comments posted it reads, “So_and_so said on function (str,
p1, offset, s) { if …”</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>MenTaLguY</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>15 Jan 2006</NOBR> at <NOBR>20:38</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Hmm, I don’t really like the seconds in the time on Redhanded now.  Are they needed?</P>

	<P>Also I get a funny and very distracting flickering as the time updates.  If you didn’t display seconds you could get away with updating it a lot less frequently…</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>why</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>15 Jan 2006</NOBR> at <NOBR>23:38</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>soory Safari users, it was absence of the <A href="http://la.ma.la/misc/js/replace_callback/">replace callback</A>.  I knew it was too good to be true!</P>

	<P>I’ve updated strftime to use a plain, old loop.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Pan</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>16 Jan 2006</NOBR> at <NOBR>13:02</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>It works now. I wouldn’t have noticed, but when you named your post “Showing <EM>perfect</EM> time”, I couldn’t resist looking for errors.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>skirch</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>18 Jan 2006</NOBR> at <NOBR>21:23</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Hey why, excellent script! One thing: I() returns 00 for 00 instead of 12, and 12 returns 00. Here’s an alternative for those of us using AM/PM:</P>

	<P>mil2reg: function(h) { return (h == 0 || h &gt; 12) ? Math.abs(h – 12) : h },
I: function(t) { return this.mil2reg(t.getHours()) },</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Eoin</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>09 Feb 2006</NOBR> at <NOBR>08:54</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>I did something like this for an ad-free world clock webpage—<A href="http://date-heure.com/en/">English world clock</A>, French: <A href="http://date-heure.com/">Fuseaux Horaires</A>—made in  PHP  with a dash of JavaScript. I think its best to do as much of this sort of thing as possible on the server end, and always have a backup in case JavaScript is not available, or the user has not set their clock correctly.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>mde</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>10 Feb 2006</NOBR> at <NOBR>17:02</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>The <A href="http://wiki.osafoundation.org/bin/view/Projects/ScoobyHome">Scooby</A> project at <A href="http://www.osafoundation.org/"> OSAF </A> has a complete JavaScript implemenation of <A href="http://wiki.osafoundation.org/bin/view/Projects/JavaScriptStrftime">Date.strftime</A>, as well as Date.add and Date.diff is its <A href="http://svn.osafoundation.org/server/scooby/trunk/src/webapp/js/date.js">date.js</A> library.</P>

	<P>Great work,  BTW . I replaced our irritating string evals with anonymous functions based on how nice your stuff looked.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Mike West</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>12 Feb 2006</NOBR> at <NOBR>14:13</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>I love this concept.</P>

	<P>I took some of the ideas in this post, and put together an unobtrusive and light JavaScript class that makes this entire process fairly transparent, and maintains the semantic quality of the  HTML  code (I’m simply not a fan of  NOSCRIPT  tags, nor of inline document.write).</P>

	<P>The class is avaliable <A href="http://mikewest.org/blog/id/20">on my blog, here</A></P>

	<P>Thanks for the inspiration!</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>mdaines</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>13 Feb 2006</NOBR> at <NOBR>15:55</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Or this for %I, which is a little shorter and in one function:</P>

	<PRE><CODE>I: function(t) { h = (t.getHours() + 12) % 12; return this.zeropad(h == 0 ? 12 : h) }</CODE></PRE>

	<P>Why does strftime have to zero-pad 12-hour hours? I would be a fan of making %i mean the hours without zero-padding and perhaps something similar for the day of the month.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>mdaines</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>13 Feb 2006</NOBR> at <NOBR>15:56</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>“12-hour hours” indeed!</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>nick</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>13 Feb 2006</NOBR> at <NOBR>19:08</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>[img-timeline]</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>pjstadig</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>03 Mar 2006</NOBR> at <NOBR>07:02</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>There are several problems (well not really problems, but shortcomings) with this method:</P>


	<P>1. As another user mentioned on ecmanaut’s blog, this does not handle the case when the time from one user (such as the timestamp on a forum post) is displayed to another user.</P>


	<P>2. This does not handle the case of a user sending a time as form data. It would come in the user’s local time, but the server would not convert it.</P>


	<P>3. This does not handle the case when you might be sending the user an e-mail or exporting  XML  or outputting data in some medium other than the web browser.</P>


	<P>I think all of this taken together means that (other than some limited circumstances) one really has no choice except to handle timezones properly.</P>


	<P>I do not mean to demean this article. It was very interesting and useful, but its application is limited. People should not think that this “solves” the timezone problem once and for all.</P></DIV></DIV>
</DIV>


  <DIV class="entry">
    <P><SMALL>Comments are closed for this entry.</SMALL></P>
  



        </DIV> 

</DIV>



</DIV>





</DIV></BODY></HTML>