<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0089)redhanded.hobix.com/inspect/usingRedcloth3.html -->
<HTML xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><HEAD><META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--<BASE href="http://redhanded.hobix.com.wstub.archive.org/inspect/usingRedcloth3.html">--><BASE href=".">


<TITLE>RedHanded » Using RedCloth 3</TITLE>
<LINK rel="shortcut icon" href="../favicon.ico" type="image/vnd.microsoft.icon" />
<LINK rel="icon" href="../favicon.ico" type="image/vnd.microsoft.icon" />
<META http-equiv="Pragma" content="no-cache">
<META http-equiv="Expires" content="-1">




<STYLE type="text/css">
 @import "../site.css"; 
</STYLE>
</HEAD><BODY>

<DIV id="page">

<DIV id="hoodwinkd">
  <A href="http://hoodwinkd.hobix.com/"><SPAN>hoodwink.d enhanced</SPAN></A>

</DIV>
<DIV id="buttons">
<DL class="tab">
  <DT><A title="Syndicate this Site" href="index.xml">RSS</A></DT>
  <DD><A title="Syndicate this Site" href="index.xml">2.0</A></DD>
</DL>
<DL class="tab xhtml">
  <DT><A title="Validate this Site" href="http://validator.w3.org/check?uri=http://redhanded.hobix.com/">XHTML</A></DT>
  <DD><A title="Validate this Site" href="http://validator.w3.org/check?uri=http://redhanded.hobix.com/">1.0</A></DD>
</DL>
</DIV>
<H1 class="title"><A href="../"><IMG src="../images/redhanded.gif" alt="RedHanded"></A></H1>
<DIV id="banner">
  <DIV class="tagline">sneaking Ruby through the system</DIV>
  <DIV class="nav"><A href="../5.gets/">5.gets</A> | <A href="../bits/">bits</A> | 
    <A href="../inspect/">inspect</A> | <A href="../cult/">the cult</A> | <A href="../-h/">-h</A></DIV>
</DIV>


<DIV id="content">
<DIV id="sidebar">
<P>New to RedHanded? <A href="../-h/pardonAndWelcome.html">About our sections.</A></P>

<DIV class="sidebarBox">
<H2 class="sidebarTitle">Archive</H2>
<UL>

    <LI><A href="../2004/12/">December 2004</A></LI>

    <LI><A href="../2005/01/">January 2005</A></LI>

    <LI><A href="../2005/02/">February 2005</A></LI>

    <LI><A href="../2005/03/">March 2005</A></LI>

    <LI><A href="../2005/04/">April 2005</A></LI>

    <LI><A href="../2005/05/">May 2005</A></LI>

    <LI><A href="../2005/06/">June 2005</A></LI>

    <LI><A href="../2005/07/">July 2005</A></LI>

    <LI><A href="../2005/08/">August 2005</A></LI>

    <LI><A href="../2005/09/">September 2005</A></LI>

    <LI><A href="../2005/10/">October 2005</A></LI>

    <LI><A href="../2005/11/">November 2005</A></LI>

    <LI><A href="../2005/12/">December 2005</A></LI>

    <LI><A href="../2006/01/">January 2006</A></LI>

    <LI><A href="../2006/02/">February 2006</A></LI>

    <LI><A href="../2006/03/">March 2006</A></LI>

    <LI><A href="../2006/04/">April 2006</A></LI>

    <LI><A href="../2006/05/">May 2006</A></LI>

    <LI><A href="../2006/06/">June 2006</A></LI>

    <LI><A href="../2006/07/">July 2006</A></LI>

    <LI><A href="../2006/08/">August 2006</A></LI>

    <LI><A href="../2006/09/">September 2006</A></LI>

    <LI><A href="../2006/10/">October 2006</A></LI>

    <LI><A href="../2006/11/">November 2006</A></LI>

    <LI><A href="../2006/12/">December 2006</A></LI>

    <LI><A href="../2007/01/">January 2007</A></LI>

    <LI><A href="../2007/02/">February 2007</A></LI>

    <LI><A href="../2007/03/">March 2007</A></LI>

    <LI><A href="../2007/04/">April 2007</A></LI>

    <LI><A href="../2007/05/">May 2007</A></LI>

</UL>
</DIV>

<P><A href="http://www.pragmaticprogrammer.com/titles/ruby/index.html"><IMG src="../images/prag-ruby-book.jpg" alt="PickAxe II"></A><BR>
<A href="http://www.pragmaticprogrammer.com/titles/ruby/index.html">Get your copy of <I>Programming Ruby</I>!</A></P>

 <DIV class="sidebarBox">
        <H2 class="sidebarTitle">Links</H2>
        <A href="http://technorati.com/tags/ruby">@technorati</A><BR>
<A href="http://del.icio.us/tag/ruby">@del.icio.us</A><BR>
<A href="http://www.flickr.com/photos/tags/ruby">@flickr</A><BR>
<A href="http://www.artima.com/articles/index.jsp?topic=ruby">@artima</A><BR>
<A href="http://blog.caboo.se/">@caboo</A><BR>
<A href="http://www.oreillynet.com/ruby">@oreilly</A><BR>
<A href="http://ruby-lang.org/">ruby</A><BR>
<A href="http://ruby-doc.org/">-&gt; docs</A><BR>
<A href="http://rubyforge.org/">-&gt; wares</A><BR>
<A href="http://rubygarden.org/ruby/">-&gt; wiki</A><BR>
<A href="http://www.sitepoint.com/forums/forumdisplay.php?f=227">-&gt; forum</A><BR>
<A href="http://www.rubyquiz.com/">-&gt; quizzes</A><BR>
<A href="http://planetruby.0x42.net/">-&gt; planet</A><BR>
<A href="http://meme.b9.com/cdates.html?channel=ruby-lang">-&gt; irc</A><BR>
<A href="http://www.rubyweeklynews.org/">rubyweeklynews</A><BR>
<A href="http://weblog.rubyonrails.com/">rails</A><BR>
<A href="http://wiki.rubyonrails.org/">-&gt; wiki</A><BR>
<A href="http://www.planetrubyonrails.org/">-&gt; planet</A><BR>
<A href="http://thesaq.com/rubyonrails/">-&gt; irc</A><BR>
<A href="http://anarchaia.org/">%anarchaia</A><BR>
<A href="http://project.ioni.st/">%projectionist</A><BR>
<A href="http://pugs.blogs.com/">~audreyt</A><BR>
<A href="http://dablog.rubypal.com/">~black</A><BR>
<A href="http://www.jamesbritt.com/">~britt</A><BR>
<A href="http://www.jamisbuck.org/jamis/">~buck</A><BR>
<A href="http://tomcopeland.blogs.com/juniordeveloper/">~copeland</A><BR>
<A href="http://eigenclass.org/">~fernandez</A><BR>
<A href="http://www.chadfowler.com/">~fowler</A><BR>
<A href="http://www.loudthinking.com/">~hansson</A><BR>
<A href="http://blog.segment7.net/">~hodel</A><BR>
<A href="http://slash7.com/">~hoy/7</A><BR>
<A href="http://fhwang.net/">~hwang</A><BR>
<A href="http://blog.leetsoft.com/">~luetke</A><BR>
<A href="http://www.worldlingo.com/wl/translate?wl_lp=JA-en&wl_glossary=gl1&wl_fl=3&wl_rurl=http%3A%2F%2Fwww.rubyist.net%2F%7Ematz%2F&wl_url=http%3A%2F%2Fwww.rubyist.net%2F%7Ematz%2F&wl_g_table=-3">~matz</A><BR>
<A href="http://moonbase.rydia.net/">~mental</A><BR>
<A href="http://techno-weenie.net/">~olson</A><BR>
<A href="http://pragprog.com/pragdave">~pragdave</A><BR>
<A href="http://www.livejournal.com/users/premshree/">~premshree</A><BR>
<A href="http://kronavita.de/chris/blog/">~neukirchen</A><BR>
<A href="http://www.robbyonrails.com/">~robby</A><BR>
<A href="http://www.rousette.org.uk/">~rousette</A><BR>
<A href="http://nubyonrails.com/">~topfunky</A><BR>
<A href="http://www.jvoorhis.com/">~voorhis</A><BR>
<A href="http://onestepback.org/">~weirich</A><BR>
<A href="http://blog.zenspider.com/">~zenspider</A><BR>
        </DIV> 
 <DIV class="sidebarBox">
        <H2 class="sidebarTitle">Syndicate</H2>
        <UL>
            <LI><A href="../index.xml">RSS 2.0</A></LI>
        </UL>
        </DIV> 
 <DIV class="sidebarBox">
        <P>Built upon <A href="http://hobix.com/">Hobix</A></P>
        </DIV> 
<IMG src="../images/redhanded-duck.gif" alt="Type the Duck">
<DIV class="email">Got a story for us? <A href="../mailto:redhanded@hobix.com">E-mail it!</A></DIV>
<DIV class="technorati"><P><A href="http://www.technorati.com/profile/whytheluckystiff">Technorati Profile</A>
<A href="http://www.technorati.com/cosmos/search.html?url=http%3A%2F%2Fredhanded.hobix.com"><BR>
<IMG src="../images/bubble_icon.gif" height="20" width="24" alt="Get Conversations about RedHanded &raquo; sneaking Ruby through the system"></A>
</P>
</DIV>

</DIV>


 <DIV id="blog">
        
<DIV class="entry">
    <H2 class="entryTitle">Using RedCloth 3
  <SPAN class="entryPermalink"><A href="../inspect/usingRedcloth3.html" title="Permanent link to &ldquo;Using RedCloth 3&rdquo;">#</A></SPAN>
</H2>

<DIV class="entrySection">by <A href="http://whytheluckystiff.net/" title="Visit why&#39;s homepage">why</A> 
  in <A href="../inspect" title="List of entries in the &ldquo;inspect&rdquo; category">inspect</A>
</DIV>

     <DIV class="entryContent"><P>Yeah, I get a lot of e-mail about problems with RedCloth.  I think the main problem is that I’ve neglected to explain things.  I’ve only just recently update the <A href="http://redcloth.rubyforge.org/">documentation</A> and it can be a bit much to sort through.  Especially when you really only need to know a couple of things about RedCloth 3.</P>


	<H2>Getting Textile and Markdown to Hold Hands</H2>


	<P>RedCloth 3 supports both Textile and Markdown.  Well, there’s a few Markdown items that haven’t been implemented. I believe lists, backticked code fragments, and images still need to be finished.</P>


	<P>By default, these are supported in tandem, with preference given to <STRONG>Textile</STRONG> markup.  This is only because RedCloth is historically a Textile library.</P>


	<P>However, preference can be given to Markdown.</P>


<PRE>  RedCloth::DEFAULT_RULES.replace [:markdown, :textile]
</PRE>

	<P>You can also use only one of the processors, if you prefer.</P>


	<P>This can also be done when you go to output:</P>


<PRE> &gt;&gt; r = RedCloth( &lt;&lt;RED ).to_html
 &gt;&gt; # testing
 &gt;&gt; RED
 =&gt; "&lt;ol&gt;\n\t&lt;li&gt;testing&lt;/li&gt;\n\t&lt;/ol&gt;" 

 &gt;&gt; r = RedCloth( &lt;&lt;RED ).to_html( :markdown )
 &gt;&gt; # testing
 &gt;&gt; RED
 =&gt; "&lt;h1&gt;testing&lt;/h1&gt;" 
</PRE>

	<P>Furthermore, you can mix-and-match rules from either processor to form your own custom markups.</P>


<PRE> &gt;&gt; r = RedCloth( &lt;&lt;RED ).to_html \
 ?&gt;       :block_markdown_atx, :inline_textile_link 
</PRE>

The complete list of rules is available in the RDoc for the <CODE>RedCloth#rules</CODE> accessor.
	<H2>Line Breaking with a Sledgehammer</H2>


	<P>Since RedCloth 3 supports both Textile and Markdown, there’s a bit of clash in some subtle rules.  For example, the string <CODE>4 &gt; 5</CODE> is handled differently.</P>


	<P>Textile outputs <CODE>&lt;p&gt;4 &gt; 5&lt;/p&gt;</CODE>.</P>


	<P>Markdown outputs <CODE>&lt;p&gt;4 &amp;gt; 5&lt;/p&gt;</CODE>.</P>


	<P>Generally, I side with Textile on these subtelties.  Eventually, I hope that these behaviors can be placed in rules like the above.  But I end up sort of stumbling across them inadvertantly, you know?</P>


	<P>With line breaks, I decided to side with Markdown.  I got so many complaints with line breaks converting to <CODE>&lt;br /&gt;</CODE> tags in RedCloth 2.  People just didn’t expect it.</P>


	<P>Heh, well, now people are used to it and they’re pretty disoriented using RedCloth 3!  Anyway, this is an easy one.</P>


<PRE> class RedCloth
   def hard_breaks; true; end
 end
</PRE>

	<P>This will activate classic hard-breaking globally, like in the days of RedCloth 2’s salad days.</P>


	<P>Again, can be done on a per-document basis.</P>


<PRE> &gt;&gt; RedCloth.new( &lt;&lt;RED ).to_html
 &gt;&gt; A short little paragraph
 &gt;&gt; of no consequence whatsoever.
 &gt;&gt; RED
 #=&gt; &lt;p&gt;A short, little paragraph
     of no consequence whatsoever.&lt;/p&gt;

 &gt;&gt; RedCloth.new( &lt;&lt;RED, [:hard_breaks] ).to_html
 &gt;&gt; A short little paragraph
 &gt;&gt; of no consequence whatsoever.
 &gt;&gt; RED
 #=&gt; &lt;p&gt;A short, little paragraph&lt;br /&gt;
     of no consequence whatsoever.&lt;/p&gt;
</PRE>

	<P>And, hey, I’m just doin what one guy thinks is best.  If this stuff drives you nuts, I’m open to a reversal.</P>


	<H2>Adding Yer Custom Blocks</H2>


	<P>Everyone’s always asking for custom markup.  The most common form being additional Textile prefixes.</P>


	<P>Yo, that’s easy!!</P>


<PRE> class CustomRedCloth &lt; RedCloth
   def textile_code( tag, atts, cite, content )
     "\t&lt;pre&gt;&lt;code#{ atts }&gt;#{ content }&lt;/code&gt;&lt;/pre&gt;" 
   end
 end
</PRE>

	<P>Creating textile block prefixes is simply a matter of adding a <CODE>textile_#{ prefix }</CODE> method.  We now have a <CODE>code</CODE> tag.</P>


<PRE> &gt;&gt; CustomRedCloth.new( &lt;&lt;RED ).to_html
 &gt;&gt; code. # testing
 &gt;&gt;   a = 1
 &gt;&gt;   b = 2
 &gt;&gt;   c = 3
 &gt;&gt; RED
 
 =&gt; &lt;pre&gt;&lt;code&gt;# testing
      a = 1
      b = 2
      c = 3&lt;/code&gt;&lt;/pre&gt;
 
</PRE>

	<P>You can add your own markup rules as well, but it gets a bit more complicated and I’d encourage reading the source.  It’s a matter of adding a method and a rule of the same name.  Take a look at the <CODE>block_markdown_setext</CODE> or <CODE>block_textile_prefix</CODE>.  Short six- or seven-line methods for adding more complex markup.</P></DIV> 
</DIV>
<DIV class="entryFooter"> 
    <NOBR>18 Feb 2005</NOBR> at <NOBR>15:21</NOBR>
    <NOSCRIPT></NOSCRIPT>
   | 
    8 comments
</DIV>
</DIV>
<DIV id="comments">


<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>francis</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>18 Feb 2005</NOBR> at <NOBR>15:49</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Thanks for the write-up. One note: If you’re going to continue to post blog entries about  HTML  markup, I’d recommend you add <A href="http://www.atomenabled.org/">Atom</A> support.  RSS  escaping of this stuff is wildly inconsistent. When I read this in NetNewsWire Lite, all the markup disappeared.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Austin</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>18 Feb 2005</NOBR> at <NOBR>15:54</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Thanks, _why. I haven’t yet used RedCloth, but I may look at it more in depth as I continue with  PDF ::Writer, because I’m looking to simply the markup that is supported by default. The only thing that I disagree with you on stated above is that, when writing to  HTML , &gt; should be converted to &amp;gt; as Markdown does it—otherwise, it’s not likely to be a valid  XHTML  document that’s output.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>why</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>18 Feb 2005</NOBR> at <NOBR>15:58</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Yeah, like I said, these subtleties just need to be identified and decided upon.  I was just looking at that example today and, I agree with you, I should definitely side with  XHTML  compliance before anything else.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>David</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>18 Feb 2005</NOBR> at <NOBR>18:19</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>I’m in strong favor of defaulting to hard breaks. So strong that I just added your fix to Rails’ textilize method so it’ll do so by default.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>dolphin</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>18 Feb 2005</NOBR> at <NOBR>19:04</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>Hi why,</P>


	<P>when :filter_html is set, <IMG> causes an error (!) and so does !img_url!</P>


	<P>Do you know why, _why?</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>dolphin</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>18 Feb 2005</NOBR> at <NOBR>19:07</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>By the way, the missing tag above is the “img src” tag.</P>


	<P>I tried it here in the comments, and i’m getting a 500 Internal Server Error.</P>


	<P>Hmmm….</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Bruce</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>18 Feb 2005</NOBR> at <NOBR>19:57</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>I confess I don’t get why people use br tags at all. A linebreak in most markup languages pretty much indicates a paragraph break, and with  CSS  styling, why is there the need to rely on br for formatting?</P>


	<P>I guess making it configurable makes everyone happy though.</P></DIV></DIV>
</DIV>

<DIV class="entry">
    <DIV class="entryAttrib">
        <DIV class="entryAuthor"><H3>Peter</H3></DIV>
        <DIV class="entryTime">said on 
    <NOBR>27 Oct 2005</NOBR> at <NOBR>06:01</NOBR>
    <NOSCRIPT></NOSCRIPT>
  </DIV>
    </DIV>
    <DIV class="entryContentOuter"><DIV class="entryContent"><P>def  BlogEntriesController.redcloth 
  r = RedCloth.new(“And then? <B> RAGING</B> She <STRONG>fell</STRONG>!” , [:filter_html])
  return r.to_html
  end
    def  BlogEntriesController.redcloth2 
   r = RedCloth.new( “h1. A <I>italic</I> man”, [:filter_html] )
  r.to_html
  end</P>


	<P>neither of these remove the html , the first renders partially bold the second renders italic although in this post because you are using some text formatting you cant see my <B> or <I> tags. You see I thought <B></B> should be removed / ignored using :filter_html ??? isnt it</I></B></P><B><I></I></B></DIV><B><I></I></B></DIV><B><I>
</I></B></DIV><B><I>


  <DIV class="entry">
    <P><SMALL>Comments are closed for this entry.</SMALL></P>
  



        </DIV> 

</I></B></DIV><B><I>



</I></B></DIV><B><I>





</I></B></DIV></BODY></HTML>